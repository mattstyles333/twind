<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link href="../output.css" rel="stylesheet" />
  <script
    defer
    src="https://unpkg.com/@alpinejs/intersect@3.x.x/dist/cdn.min.js"
  ></script>
  <link
    href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css"
    rel="stylesheet"
  />
  <script
    src="https://cdn.jsdelivr.net/npm/alpinejs@3.9.6/dist/cdn.min.js"
    defer
  ></script>
</head>

<div class="min-h-screen bg-gray-100">
  <!-- Header -->
  <header class="bg-white shadow">
    <div class="mx-auto flex max-w-7xl flex-col px-4 py-3 sm:px-6 sm:py-4">
      <!-- Logo and contact info container -->
      <div class="flex flex-wrap items-center justify-between gap-4">
        <img
          src="https://www.spex4less.com/media/mf_webp/png/media/wysiwyg/redesign/s4l-logo.webp"
          alt="Spex4Less"
          class="h-12 sm:h-20"
        />
        <div
          class="flex flex-col items-start justify-start gap-2 lg:flex-row lg:gap-6"
        >
          <div class="flex items-center text-sm lg:text-base">
            <div class="flex h-6 w-6 items-center justify-center">
              <svg
                viewBox="0 0 512 385"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
                class="h-5 w-5"
              >
                <path
                  fill-rule="evenodd"
                  clip-rule="evenodd"
                  d="M37.263 1.58379C2.234 9.19379 -12.022 52.8898 12.315 78.0508C16.993 82.8878 229.486 225.034 237.5 228.689C249.004 233.934 263.566 233.745 275.5 228.195C278.8 226.66 329.425 193.442 388 154.377C498.462 80.7068 501.778 78.3058 506.911 68.2448C520.712 41.1918 504.437 7.9318 474.27 1.5388C464.451 -0.541204 46.849 -0.499205 37.263 1.58379ZM0 224.437C0 305.426 0.336 342.588 1.102 346.271C4.804 364.079 19.605 378.76 37.73 382.601C47.883 384.752 464.117 384.752 474.27 382.601C492.734 378.688 507.561 363.723 510.96 345.57C511.762 341.29 512 306.384 511.792 223.82L511.5 108.071L405 179.132C346.425 218.215 294.958 251.997 290.63 254.203C278.941 260.159 269.777 262.302 256 262.302C242.506 262.302 233.134 260.177 222.08 254.61C218.148 252.63 166.909 218.961 108.215 179.79C49.522 140.619 1.163 108.42 0.75 108.237C0.337 108.053 0 160.344 0 224.437Z"
                  fill="#1f2937"
                ></path>
              </svg>
            </div>
            <p class="ml-2">Email: Info@spex4less.com</p>
          </div>
          <div class="flex items-center text-sm lg:text-base">
            <div class="flex h-6 w-6 items-center justify-center">
              <svg
                viewBox="0 0 828 828"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
                class="h-5 w-5"
              >
                <path
                  d="M0.500325 162.812L0.500323 162.811C0.472712 158.127 2.21311 151.832 5.43143 144.44C8.64441 137.059 13.3095 128.63 19.0828 119.69C30.6292 101.812 46.5869 81.9249 64.162 64.3499C81.7406 46.7713 101.08 30.7925 118.075 19.2121C126.573 13.4216 134.476 8.73656 141.273 5.50118C148.087 2.25781 153.732 0.5 157.732 0.5C159.68 0.5 162.097 1.19718 164.934 2.57627C167.765 3.95195 170.977 5.98799 174.506 8.62198C181.563 13.8897 189.847 21.5192 198.817 30.9499C216.755 49.8092 237.4 75.8312 256.416 104.459C273.363 129.985 286.113 149.321 295.259 164.899C304.406 180.48 309.926 192.265 312.438 202.691C317.447 223.488 310.521 238.976 296.061 268.66L266.566 329.174L266.412 329.491L266.658 329.743L380.365 445.821L494.09 561.918L494.34 562.173L494.663 562.019L557.191 532.186C588.037 517.478 603.886 510.373 624.838 515.321C635.339 517.801 647.148 523.317 662.773 532.496C678.396 541.674 697.798 554.49 723.485 571.546C752.131 590.572 778.167 611.226 797.036 629.171C806.471 638.145 814.104 646.431 819.375 653.491C822.01 657.021 824.047 660.234 825.423 663.065C826.803 665.903 827.5 668.32 827.5 670.267C827.5 675.336 825.656 681.607 822.296 688.73C818.94 695.844 814.093 703.766 808.133 712.124C796.213 728.839 779.869 747.26 762.19 764.388C744.511 781.515 725.512 797.336 708.286 808.857C699.672 814.617 691.512 819.297 684.188 822.528C676.856 825.762 670.401 827.527 665.188 827.5C641.13 827.373 612.708 819.93 581.368 806.59C550.033 793.253 515.811 774.035 480.158 750.389C408.854 703.098 331.864 638.118 260.873 567.127C189.882 496.136 124.902 419.146 77.6105 347.842C53.9648 312.189 34.7467 277.967 21.4097 246.632C8.07045 215.292 0.626888 186.87 0.500325 162.812Z"
                  fill="#1f2937"
                  stroke="black"
                ></path>
              </svg>
            </div>
            <p class="ml-2">Tel: 0151 632 6611</p>
          </div>
        </div>
        <!-- Progress bar section - now full width on mobile -->
        <div
          class="flex w-full flex-row items-center justify-between sm:w-auto md:flex-col"
        >
          <div
            class="flex flex-row items-center justify-center space-x-2 sm:flex-row sm:items-center sm:space-x-4 sm:space-y-0"
          >
            <span class="text-base text-gray-600">Review & Pay</span>
            <div class="flex space-x-2">
              <a href="v1.html" class="h-3 w-8 rounded bg-blue-600 sm:w-12"></a>
              <div class="h-3 w-8 rounded bg-gray-300 sm:w-12"></div>
            </div>
          </div>
          <div class="ml-auto">
            <a
              href="v1.html"
              class="flex w-fit items-center text-gray-600 hover:text-gray-900"
            >
              <svg
                class="h-6 w-6 sm:h-8 sm:w-8"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M15 19l-7-7 7-7"
                />
              </svg>
              <span class="ml-1 text-sm">Back</span>
            </a>
          </div>
        </div>
      </div>
    </div>
  </header>

  <!-- Main Content -->
  <main
    class="mx-auto grid max-w-7xl grid-cols-1 items-start gap-y-4 px-4 py-4 lg:grid-cols-3 lg:gap-x-6 lg:py-8"
  >
    <!-- Left section with self-alignment -->
    <section class="col-span-2 h-fit self-start rounded-lg bg-white p-6 shadow">
      <!-- Add mobile order summary toggle button -->
      <button
        x-data
        @click="$store.orderSummary.toggle()"
        class="mb-4 flex w-full items-center justify-between rounded-lg border-2 border-gray-200 p-2 text-left lg:hidden"
      >
        <div class="flex items-center space-x-2">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            fill="none"
            viewBox="0 0 24 24"
            stroke-width="2"
            stroke="currentColor"
            class="h-8 w-8 text-gray-700 hover:text-black"
            width="12"
            height="12"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"
            ></path>
            <title>shopping-cart</title>
          </svg>
          <span class="text-gray-700">View Order Summary</span>
        </div>
        <div class="flex items-center space-x-2">
          <span class="font-bold">£24.89</span>
          <svg
            class="h-5 w-5 text-gray-700"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M9 5l7 7-7 7"
            />
          </svg>
        </div>
      </button>

      <h2 class="mb-4 text-xl font-semibold text-gray-700">Shipping Address</h2>

      <!-- Address List -->
      <div class="space-y-4" x-data="{ selectedAddress: 0 }">
        <div
          @click="selectedAddress = 0; $store.orderSummary.toggle()"
          class="cursor-pointer rounded-lg border p-4"
          :class="selectedAddress === 0 ? 'border-blue-600 bg-blue-50' : 'border-gray-300'"
        >
          <div
            class="flex flex-col md:flex-row md:items-center md:justify-between lg:flex"
          >
            <div>
              <p class="font-medium text-gray-700">James Tanner</p>
              <p class="text-sm text-gray-600">
                Spex4Less, Everite House, Carr Lane, Hoylake, Merseyside CH47
                4BG
              </p>
              <p class="text-sm text-gray-600">+44 151 632 6611</p>
            </div>
            <div class="mt-2 lg:mt-0">
              <button class="text-blue-600">Edit</button>
            </div>
          </div>
        </div>

        <div
          @click="selectedAddress = 1; $store.orderSummary.toggle()"
          class="cursor-pointer rounded-lg border p-4"
          :class="selectedAddress === 1 ? 'border-blue-600 bg-blue-50' : 'border-gray-300'"
        >
          <div
            class="flex flex-col md:flex-row md:items-center md:justify-between lg:flex"
          >
            <div>
              <p class="font-medium text-gray-700">Sarah Smith</p>
              <p class="text-sm text-gray-600">
                123 Main Street, Apartment 4B, Liverpool, Merseyside L1 1AA
              </p>
              <p class="text-sm text-gray-600">+44 151 555 0123</p>
            </div>
            <div class="mt-2 lg:mt-0">
              <button class="text-blue-600">Edit</button>
            </div>
          </div>
        </div>

        <div
          @click="selectedAddress = 2; $store.orderSummary.toggle()"
          class="cursor-pointer rounded-lg border p-4"
          :class="selectedAddress === 2 ? 'border-blue-600 bg-blue-50' : 'border-gray-300'"
        >
          <div
            class="flex flex-col md:flex-row md:items-center md:justify-between lg:flex"
          >
            <div>
              <p class="font-medium text-gray-700">John Davies</p>
              <p class="text-sm text-gray-600">
                45 Church Road, West Kirby, Wirral, Merseyside CH48 3JT
              </p>
              <p class="text-sm text-gray-600">+44 151 625 8899</p>
            </div>
            <div class="mt-2 lg:mt-0">
              <button class="text-blue-600">Edit</button>
            </div>
          </div>
        </div>

        <div class="mt-4 flex items-center justify-between">
          <button class="text-blue-600 hover:underline">
            + Add New Address
          </button>
        </div>
      </div>

      <!-- Shipping Methods -->
      <div class="mt-8">
        <h2 class="mb-4 text-xl font-semibold text-gray-700">
          Shipping Methods
        </h2>
        <div class="space-y-4">
          <label class="flex cursor-pointer items-center space-x-3">
            <input
              type="radio"
              name="shipping"
              value="standard"
              class="form-radio text-blue-600"
              checked
            />
            <span class="text-gray-700">Standard Delivery (Free)</span>
          </label>
        </div>
      </div>
      <a
        href="step-2.html"
        class="bg-s float-right mt-4 w-1/3 rounded-lg px-6 py-2 text-center font-bold text-white transition hover:bg-blue-700"
      >
        Next
      </a>
    </section>

    <!-- Replace existing Order Summary with new mobile-friendly version -->
    <aside
      x-cloak
      x-data
      x-show="$store.orderSummary.isOpen || $store.orderSummary.isLargeScreen"
      @click.away="if(!$store.orderSummary.isLargeScreen) $store.orderSummary.close()"
      x-transition:enter="transition ease-out duration-300"
      x-transition:enter-start="translate-x-full"
      x-transition:enter-end="translate-x-0"
      x-transition:leave="transition ease-in duration-300"
      x-transition:leave-start="translate-x-0"
      x-transition:leave-end="translate-x-full"
      class="fixed inset-y-0 right-0 z-50 w-full overflow-y-auto rounded-lg bg-white p-4 shadow-xl lg:static lg:inset-auto lg:block lg:w-auto lg:transform-none lg:p-6 lg:shadow"
      style="max-width: 400px"
    >
      <!-- Add close button for mobile -->
      <button
        @click="$store.orderSummary.close()"
        class="absolute right-4 top-4 text-gray-500 lg:hidden"
      >
        <svg
          class="h-6 w-6"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M6 18L18 6M6 6l12 12"
          />
        </svg>
      </button>

      <h2 class="mb-4 text-xl font-semibold text-gray-700">Order Summary</h2>
      <div class="border-t border-gray-300 py-2">
        <div class="mt-2 space-y-4">
          <div class="flex items-center gap-4">
            <img
              src="https://test.s4l.link/media/catalog/product/cache/e228b33174e6210dd02020993ba7c78c/o/l/ol007_-_c1.png"
              alt="Product Image"
              class="h-16 w-24 rounded object-cover"
            />
            <div>
              <p class="font-medium text-gray-700">OL 007 Glasses</p>
              <p class="text-sm text-gray-600">Size: 55-18-140</p>
              <p class="text-sm text-gray-600">Colour: Gunmetal</p>
              <p class="text-sm text-gray-600">Select Lenses: Distance £5.00</p>
              <p class="text-sm text-gray-600">
                Distance Type: Standard Distance £0.00
              </p>
              <p class="text-sm text-gray-600">
                Lens Index (Thinness): 1.5 Standard £0.00
              </p>
              <p class="text-sm text-gray-600">Lens Colour: Clear £0.00</p>
              <p class="text-sm text-gray-600">
                Coatings: UV and Durable+ £10.00
              </p>
            </div>
          </div>
          <hr class="my-2 w-full border-t border-gray-300" />
          <div class="flex items-center gap-4">
            <img
              src="https://test.s4l.link/media/catalog/product/cache/e228b33174e6210dd02020993ba7c78c/o/l/ol007_-_c1.png"
              alt="Product Image"
              class="h-16 w-24 rounded object-cover"
            />
            <div>
              <p class="font-medium text-gray-700">OL 007 Glasses</p>
              <p class="text-sm text-gray-600">Size: 55-18-140</p>
              <p class="text-sm text-gray-600">Colour: Gunmetal</p>
              <p class="text-sm text-gray-600">Select Lenses: Distance £5.00</p>
              <p class="text-sm text-gray-600">
                Distance Type: Standard Distance £0.00
              </p>
              <p class="text-sm text-gray-600">
                Lens Index (Thinness): 1.5 Standard £0.00
              </p>
              <p class="text-sm text-gray-600">Lens Colour: Clear £0.00</p>
              <p class="text-sm text-gray-600">
                Coatings: UV and Durable+ £10.00
              </p>
            </div>
          </div>
        </div>
        <div class="mt-4 flex justify-between border-t border-gray-300 pt-4">
          <p class="font-medium text-gray-700">Total</p>
          <p class="text-lg font-bold text-gray-900">£31.97</p>
        </div>
      </div>
    </aside>
  </main>
</div>

<!-- Add Alpine.js store script before closing body tag -->
<script>
  document.addEventListener("alpine:init", () => {
    Alpine.store("orderSummary", {
      isOpen: false,
      isLargeScreen: window.innerWidth >= 1024,
      toggle() {
        this.isOpen = !this.isOpen;
      },
      close() {
        this.isOpen = false;
      },
      init() {
        window.addEventListener("resize", () => {
          this.isLargeScreen = window.innerWidth >= 1024;
        });
      },
    });
  });
</script>
