<section class="py-4 bg-white md:py-6">
  {{ $len := len .brands }}
  <div class="px-4 mx-auto lg:px-6 max-w-8xl" x-data="{ expanded: false }" data-total="{{ $len }}">
    <div class="grid grid-cols-3 gap-2 justify-items-center items-center md:gap-4 md:flex md:justify-between md:gap-2">
      {{ range $i, $brand := .brands }}
      <a
        href="{{ $brand.url }}"
        class="p-2 w-24 rounded-lg border border-gray-200 transition-transform md:w-24 md:hover:scale-105 md:border-0 md:w-40"
        data-i="{{ $i }}"
        x-cloak
        x-show="$el.dataset.i < (expanded ? Math.min(24, +$root.dataset.total) : 8)"
      >
        {{ partial "image.html" (dict
          "src" $brand.logo
          "alt" $brand.name
          "width" 300
          "height" 127
          "class" "object-contain mx-auto w-full h-14 md:h-16"
          "placeholder" true
          "placeholder_service" "placeholder"
          "placeholder_category" "BRAND"
        ) }}
      </a>
      {{ if and (lt $i (sub $len 1)) (not (eq $i 2)) }}
      <div
        class="hidden mx-2 w-px h-8 bg-gray-300 md:block"
        data-i="{{ $i }}"
        x-cloak
        x-show="$el.dataset.i < ((expanded ? Math.min(24, +$root.dataset.total) : 8) - 1) && $el.dataset.i != 2"
      ></div>
      {{ end }}
      {{ end }}
    </div>
    {{ if gt $len 8 }}
    <div class="mt-4 text-center">
      <button
        type="button"
        class="px-4 py-2 text-sm font-medium text-slate-700 bg-white border border-gray-300 rounded-md shadow-sm hover:bg-gray-50"
        @click="expanded = !expanded"
      >
        <span x-show="!expanded">Show more</span>
        <span x-show="expanded">Show less</span>
      </button>
      <div class="mt-2 text-xs text-gray-500" x-cloak x-show="expanded && +$root.dataset.total > 24">
        Showing 24 of {{ $len }} brands
      </div>
    </div>
    {{ end }}
  </div>
</section>
