<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta
    name="description"
    content="Interactive product quiz to help you find the perfect product based on your preferences."
  />
  <title>Product Quiz</title>
  <link
    href="https://cdn.jsdelivr.net/npm/tailwindcss@latest/dist/tailwind.min.css"
    rel="stylesheet"
  />
  <script
    src="https://cdn.jsdelivr.net/npm/alpinejs@latest/dist/alpine.js"
    defer
  ></script>
</head>
<div x-data="quizApp()" class="space-y-6 rounded-lg p-4">
  <div class="text-center">
    <p class="text-lg font-semibold text-gray-700">Select your gender:</p>
    <div class="mx-auto mt-2 flex max-w-3xl justify-center gap-4">
      <button
        @click="selectGender('Mens')"
        class="btn w-full rounded border-2 border-gray-400 bg-white px-4 py-2 text-center font-bold text-black hover:bg-gray-100 hover:text-black"
      >
        <p class="text-center">Mens Test2</p>
      </button>

      <button
        @click="selectGender('Womens')"
        class="btn w-full rounded border-2 border-gray-400 bg-white px-4 py-2 text-center font-bold text-black hover:bg-gray-100 hover:text-black"
      >
        <p class="text-center">Womens</p>
      </button>
    </div>
  </div>

  <div x-show="selectedGender" class="text-center">
    <p class="text-lg font-semibold text-gray-700">Select your face shape:</p>
    <div class="mx-auto mt-2 grid max-w-3xl grid-cols-3 gap-4">
      <button
        @click="selectFaceShape('Oval')"
        class="flex w-full items-center justify-between rounded border-2 border-gray-400 bg-white px-4 py-2 font-bold text-gray-800 hover:bg-gray-100"
        :class="{'text-white bg-gray-200': selectedFaceShape === 'Oval'}"
      >
        <span class="mx-auto w-2/3 text-center">Oval</span>
        <span class="mx-auto flex w-1/3 items-center justify-end">
          <img
            src="https://www.spex4less.com/media/mf_webp/png/media/wysiwyg/quiz/Oval.webp"
            alt="Oval Face Shape"
            class="mx-auto h-auto w-full"
          />
        </span>
      </button>

      <button
        @click="selectFaceShape('Round')"
        class="flex w-full items-center justify-between rounded border-2 border-gray-400 bg-white px-4 py-2 font-bold text-gray-800 hover:bg-gray-100"
        :class="{'text-white bg-gray-200': selectedFaceShape === 'Round'}"
      >
        <span class="w-2/3 px-2 text-center">Round</span>
        <span class="flex w-1/3 items-center justify-end">
          <img
            src="https://www.spex4less.com/media/mf_webp/png/media/wysiwyg/quiz/Round.webp"
            alt="Round Face Shape"
            class="h-auto w-full"
          />
        </span>
      </button>

      <button
        @click="selectFaceShape('Square')"
        class="flex w-full items-center justify-between rounded border-2 border-gray-400 bg-white px-4 py-2 font-bold text-gray-800 hover:bg-gray-100"
        :class="{'text-white bg-gray-200': selectedFaceShape === 'Square'}"
      >
        <span class="w-2/3 px-2 text-center">Square</span>
        <span class="flex w-1/3 items-center justify-end">
          <img
            src="https://www.spex4less.com/media/mf_webp/png/media/wysiwyg/quiz/Square.webp"
            alt="Square Face Shape"
            class="h-auto w-full"
          />
        </span>
      </button>

      <button
        @click="selectFaceShape('Heart')"
        class="flex w-full items-center justify-between rounded border-2 border-gray-400 bg-white px-4 py-2 font-bold text-gray-800 hover:bg-gray-100"
        :class="{'text-white bg-gray-200': selectedFaceShape === 'Heart'}"
      >
        <span class="w-2/3 px-2 text-center">Heart</span>
        <span class="flex w-1/3 items-center justify-end">
          <img
            src="https://www.spex4less.com/media/mf_webp/png/media/wysiwyg/quiz/Heart.webp"
            alt="Heart Face Shape"
            class="h-auto w-full"
          />
        </span>
      </button>

      <button
        @click="selectFaceShape('Diamond')"
        class="flex w-full items-center justify-between rounded border-2 border-gray-400 bg-white px-4 py-2 font-bold text-gray-800 hover:bg-gray-100"
        :class="{'text-white bg-gray-200': selectedFaceShape === 'Diamond'}"
      >
        <span class="w-2/3 px-2 text-center">Diamond</span>
        <span class="flex w-1/3 items-center justify-end">
          <img
            src="https://www.spex4less.com/media/mf_webp/png/media/wysiwyg/quiz/Diamond.webp"
            alt="Diamond Face Shape"
            class="h-auto w-full"
          />
        </span>
      </button>

      <button
        @click="selectFaceShape('Rectangular')"
        class="flex w-full items-center justify-between rounded border-2 border-gray-400 bg-white px-4 py-2 font-bold text-gray-800 hover:bg-gray-100"
        :class="{'text-white bg-gray-200': selectedFaceShape === 'Regular'}"
      >
        <span class="w-2/3 px-2 text-center">Rectangular</span>
        <span class="flex w-1/3 items-center justify-end">
          <img
            src="https://www.spex4less.com/media/mf_webp/png/media/wysiwyg/quiz/Rectangle.webp"
            alt="Regular Face Shape"
            class="h-auto w-full"
          />
        </span>
      </button>
    </div>
  </div>

  <div x-show="selectedFaceShape" class="text-center">
    <p class="text-lg font-semibold text-gray-700">
      Select your frame width/face size:
    </p>
    <div class="mx-auto mt-2 flex max-w-3xl justify-center gap-4">
      <button
        @click="selectFrameSize('115-130')"
        class="btn w-full rounded border-2 border-gray-400 bg-white px-4 py-2 text-center font-bold text-gray-800 hover:bg-gray-100"
        :class="{'text-white bg-gray-200': selectedFrameSize === '115-130'}"
      >
        <p class="text-center">Small</p>
      </button>
      <button
        @click="selectFrameSize('125-140')"
        class="btn w-full rounded border-2 border-gray-400 bg-white px-4 py-2 text-center font-bold text-gray-800 hover:bg-gray-100"
        :class="{'text-white bg-gray-200': selectedFrameSize === '125-140'}"
      >
        <p class="text-center">Medium</p>
      </button>
      <button
        @click="selectFrameSize('135-150')"
        class="btn w-full rounded border-2 border-gray-400 bg-white px-4 py-2 text-center font-bold text-gray-800 hover:bg-gray-100"
        :class="{'text-white bg-gray-200': selectedFrameSize === '135-150'}"
      >
        <p class="text-center">Large</p>
      </button>
    </div>
  </div>
  <div x-show="selectedFrameSize" class="text-center">
    <p class="text-lg font-semibold text-gray-700">Select your budget:</p>
    <div class="mx-auto mt-2 flex max-w-3xl justify-center gap-4">
      <button
        @click="selectBudget('Under £50')"
        class="btn w-full rounded border-2 border-gray-400 bg-white px-4 py-2 text-center font-bold text-black hover:bg-gray-100 hover:text-black"
        :class="{'bg-gray-200': selectedBudget === 'Under £50'}"
      >
        <p class="text-center">Under £50</p>
      </button>
      <button
        @click="selectBudget('£50 - £100')"
        class="btn w-full rounded border-2 border-gray-400 bg-white px-4 py-2 text-center font-bold text-black hover:bg-gray-100 hover:text-black"
        :class="{'bg-gray-200': selectedBudget === '£50 - £100'}"
      >
        <p class="text-center">£50 - £100</p>
      </button>
      <button
        @click="selectBudget('Over £100')"
        class="btn w-full rounded border-2 border-gray-400 bg-white px-4 py-2 text-center font-bold text-black hover:bg-gray-100 hover:text-black"
        :class="{'bg-gray-200': selectedBudget === 'Over £100'}"
      >
        <p class="text-center">Over £100</p>
      </button>
      <button
        @click="selectBudget('Skip')"
        class="btn w-full rounded border-2 border-gray-400 bg-white px-4 py-2 text-center font-bold text-black hover:bg-gray-100 hover:text-black"
      >
        <p class="text-center">Skip</p>
      </button>
    </div>
  </div>

  <div x-show="selectedBudget" class="text-center">
    <p class="text-lg font-semibold text-gray-700">
      Select your preferred brand:
    </p>
    <div class="mx-auto mt-2 flex max-w-3xl flex-wrap justify-center gap-4">
      <template x-for="brand in displayedBrands" :key="brand">
        <button
          @click="selectBrand(brand)"
          x-text="brand"
          class="flex-1 rounded border-2 border-gray-400 bg-white px-4 py-2 text-center font-bold text-black hover:bg-gray-100 hover:text-black"
          :class="{'bg-gray-200': selectedBrand === brand}"
        ></button>
      </template>
    </div>
  </div>

  <div x-show="selectedBrand" class="text-center">
    <h2 class="text-xl font-semibold text-gray-800">
      Recommended Styles for
      <span x-text="selectedFaceShape" class="text-blue-600"></span>
      Faces
    </h2>
    <div class="mx-auto mt-2 grid max-w-3xl grid-cols-3 gap-4">
      <template x-for="style in recommendedStyles" :key="style">
        <a
          :href="`https://www.spex4less.com/all-frames?a1_frame_gender=${selectedGender}&a1_frame_style=${encodeURIComponent(style)}&width=${selectedFrameSize}&price=${getBudgetQueryParam()}&a1_brand=${encodeURIComponent(selectedBrand)}`"
          class="card rounded border-2 border-gray-400 bg-white px-4 py-2 font-semibold text-gray-800 shadow hover:bg-gray-100"
          target="_blank"
        >
          <p x-text="`Style: ${style}`" class="text-center"></p>
        </a>
      </template>
    </div>
  </div>
</div>
<script>
  function quizApp() {
    return {
      selectedGender: "",
      selectedFaceShape: "",
      selectedFrameSize: "",
      selectedBudget: "",
      selectedBrand: "",
      allBrands: [
        "Boss",
        "Ray-ban",
        "Oakley",
        "Superdry",
        "Tom Ford",
        "Nike",
        "Cat",
      ],
      displayedBrands: [],
      budgetToBrands: {
        Skip: [
          "Boss",
          "Ray-ban",
          "Oakley",
          "Superdry",
          "Tom Ford",
          "Nike",
          "Cat",
        ], // Show all brands when budget is skipped
        "Under £50": ["Cat", "Superdry", "Polaroid"],
        "£50 - £100": ["Ray-ban", "Nike", "Oakley"],
        "Over £100": ["Boss", "Tom Ford", "Oakley"],
      },
      faceShapes: {
        Oval: {
          "115-130": ["Oval", "Cateye", "Round"],
          "125-140": ["Oversized", "Wayfarer", "Aviator"],
          "135-150": ["Regular", "Square", "Clubmaster"],
        },
        Round: {
          "115-130": ["Regular", "Square", "Keyhole"],
          "125-140": ["Regular", "Square", "Clubmaster"],
          "135-150": ["Regular", "Oversized", "Square"],
        },
        Square: {
          "115-130": ["Oval", "Round", "Cateye"],
          "125-140": ["Round", "Oval", "Cateye"],
          "135-150": ["Oval", "Round", "Aviator"],
        },
        Heart: {
          "115-130": ["Oval", "Round", "Cateye"],
          "125-140": ["Cateye", "Round", "Oval"],
          "135-150": ["Round", "Oval", "Cateye"],
        },
        Diamond: {
          "115-130": ["Oval", "Round", "Cateye"],
          "125-140": ["Oval", "Cateye", "Round"],
          "135-150": ["Oval", "Cateye", "Round"],
        },
        Rectangular: {
          "115-130": ["Round", "Oval", "Cateye"],
          "125-140": ["Round", "Oval", "Cateye"],
          "135-150": ["Oval", "Round", "Cateye"],
        },
      },
      recommendedStyles: [],
      selectGender(gender) {
        this.selectedGender = gender;
      },
      selectFaceShape(shape) {
        this.selectedFaceShape = shape;
        this.updateRecommendedStyles();
      },
      selectFrameSize(size) {
        this.selectedFrameSize = size;
        this.updateRecommendedStyles();
      },
      selectBudget(budget) {
        this.selectedBudget = budget;
        this.updateDisplayedBrands();
        if (budget === "") {
          this.selectedBrand = ""; // Reset brand selection when skipping budget
        }
        this.updateRecommendedStyles();
      },
      selectBrand(brand) {
        this.selectedBrand = brand;
        this.updateRecommendedStyles();
      },
      getBudgetQueryParam() {
        switch (this.selectedBudget) {
          case "Skip":
            return "";
          case "Under £50":
            return "0-49.99";
          case "£50 - £100":
            return "50-100";
          case "Over £100":
            return "101-";
          default:
            return "";
        }
      },
      updateDisplayedBrands() {
        if (this.selectedBudget === "") {
          this.displayedBrands = this.allBrands; // Show all brands if budget is skipped
        } else {
          this.displayedBrands = this.budgetToBrands[this.selectedBudget] || [];
        }
      },
      updateRecommendedStyles() {
        if (
          this.selectedFaceShape &&
          this.selectedFrameSize &&
          (this.selectedBrand || this.selectedBudget === "")
        ) {
          let styles =
            this.faceShapes[this.selectedFaceShape][this.selectedFrameSize];
          if (this.selectedGender.toLowerCase() === "mens") {
            styles = styles.map((style) =>
              style.toLowerCase() === "cateye" ? "Regular" : style,
            );
          }
          this.recommendedStyles = styles;
        }
      },
    };
  }
</script>