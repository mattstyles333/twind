<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link href="../output.css" rel="stylesheet" />
  <script
    defer
    src="https://unpkg.com/@alpinejs/intersect@3.x.x/dist/cdn.min.js"
  ></script>
  <script
    src="https://cdn.jsdelivr.net/npm/alpinejs@3.9.6/dist/cdn.min.js"
    defer
  ></script>

  <script
    type="text/javascript"
    src="//widget.trustpilot.com/bootstrap/v5/tp.widget.bootstrap.min.js"
    async
  ></script>
</head>

<section class="body-font text-gray-700">
  <div class="flex flex-col items-center md:pt-6 lg:flex-row">
    <div
      class="grid-rows-auto grid w-full grid-cols-1 bg-white md:grid-cols-[42%_minmax(0,_1fr)] md:grid-rows-[min-content_minmax(0,_1fr)] md:gap-x-5 lg:grid-cols-2 lg:gap-x-10"
    >
      <div
        class="page-title-container product container mb-2 flex flex-col flex-wrap px-4 pt-4 text-center text-3xl text-4xl font-bold font-semibold md:flex-row"
      >
        <h1 class="page-title title-font text-gray-900">
          <span class="base" data-ui-id="page-title-wrapper" itemprop="name"
            >Amelia Salvini Glasses | AC395F</span
          >
        </h1>
      </div>
      <div
        id="gallery"
        x-data="initGallery()"
        x-bind="eventListeners"
        class="relative flex w-full items-center pt-6 md:col-start-1 md:row-span-2 md:row-start-1 md:h-auto md:pt-0"
      >
        <picture class="mfwebp">
          <source
            type="image/webp"
            srcset="
              https://www.spex4less.com/media/mf_webp/jpg/media/logos/brand-logos/hyva-spex4less/small/salvini.webp
            " />
          <img
            data-webpconverted="1"
            src="https://www.spex4less.com/media/logos/brand-logos/hyva-spex4less/small/salvini.jpg"
            alt="brand-logo"
            class="absolute left-2 top-4 z-10 max-w-[110px]"
        /></picture>
        <div
          :class="{'w-full h-full fixed block top-0 left-0 bg-white z-50 flex': fullscreen}"
          :role="fullscreen ? 'dialog' : false"
          :aria-modal="fullscreen"
          :aria-label="fullscreen ? 'Gallery\u0020modal\u0020fullscreen' : false"
        >
          <div
            class="relative w-full self-center"
            @touchstart="handleTouchStart"
            @touchmove="handleTouchMove"
            x-transition:enter="ease-out duration-500"
            x-transition:enter-start="opacity-0"
            x-transition:enter-end="opacity-100"
          >
            <div class="relative mb-6" aria-live="polite" aria-atomic="true">
              <span class="hidden" id="main-image-description">Main image</span>
              <span class="hidden" id="fullscreen-btn-label"
                >Click to view image in fullscreen</span
              >
              <div class="relative inline-block">
                <picture class="mfwebp">
                  <source
                    title=""
                    :class="'invisible'"
                    width="830"
                    height="415"
                    @click="openFullscreen($root)"
                    type="image/webp"
                    srcset="
                      https://www.spex4less.com/media/mf_webp/jpeg/media/catalog/product/cache/5126638460848648518cefac96e6dd88/u/n/untitled-1_36_.webp
                    "
                    class="invisible" />
                  <img
                    alt=""
                    title=""
                    class="max-h-screen-75 invisible h-auto w-full object-contain object-center"
                    :class="'invisible'"
                    src="https://www.spex4less.com/media/catalog/product/cache/5126638460848648518cefac96e6dd88/u/n/untitled-1_36_.jpeg"
                    width="830"
                    height="415"
                    @click="openFullscreen($root)"
                /></picture>
                <meta
                  itemprop="image"
                  content="https://www.spex4less.com/media/mf_webp/jpeg/media/catalog/product/cache/5126638460848648518cefac96e6dd88/u/n/untitled-1_36_.webp"
                />
              </div>
              <template x-for="(image, index) in images" :key="index">
                <img
                  x-ref="galleryMainImage"
                  :alt="image.caption || 'Amelia\u0020Salvini\u0020Glasses\u0020\u007C\u0020AC395F'"
                  :title="image.caption || 'Amelia\u0020Salvini\u0020Glasses\u0020\u007C\u0020AC395F'"
                  @click="openFullscreen($root)"
                  class="max-h-screen-75 absolute inset-0 w-full object-contain object-center"
                  :class="{ 'cursor-pointer': !fullscreen }"
                  width="830"
                  height="415"
                  :loading="active!==index ? 'lazy' : 'eager'"
                  :src="fullscreen ? image.full : image.img"
                  x-transition.opacity.duration.500ms=""
                  x-show="active===index"
                  @keydown.enter="openFullscreen($root)"
                  :tabindex="fullscreen ? '-1' : '0'"
                  :aria-describedby="fullscreen
                            ? ''
                            : 'main-image-description fullscreen-btn-label'
                        "
                  :role="fullscreen ? 'img' : 'button'"
                /> </template
              ><img
                x-ref="galleryMainImage"
                :alt="image.caption || 'Amelia\u0020Salvini\u0020Glasses\u0020\u007C\u0020AC395F'"
                :title="image.caption || 'Amelia\u0020Salvini\u0020Glasses\u0020\u007C\u0020AC395F'"
                @click="openFullscreen($root)"
                class="max-h-screen-75 absolute inset-0 w-full cursor-pointer object-contain object-center"
                :class="{ 'cursor-pointer': !fullscreen }"
                width="830"
                height="415"
                :loading="active!==index ? 'lazy' : 'eager'"
                :src="fullscreen ? image.full : image.img"
                x-transition.opacity.duration.500ms=""
                x-show="active===index"
                @keydown.enter="openFullscreen($root)"
                :tabindex="fullscreen ? '-1' : '0'"
                :aria-describedby="fullscreen
                            ? ''
                            : 'main-image-description fullscreen-btn-label'
                        "
                :role="fullscreen ? 'img' : 'button'"
                alt="Amelia Salvini Glasses | AC395F"
                title="Amelia Salvini Glasses | AC395F"
                loading="lazy"
                src="https://www.spex4less.com/media/mf_webp/jpeg/media/catalog/product/cache/5126638460848648518cefac96e6dd88/u/n/untitled-1_36_.webp"
                tabindex="0"
                aria-describedby="main-image-description fullscreen-btn-label"
                role="button"
                style="display: none"
              /><img
                x-ref="galleryMainImage"
                :alt="image.caption || 'Amelia\u0020Salvini\u0020Glasses\u0020\u007C\u0020AC395F'"
                :title="image.caption || 'Amelia\u0020Salvini\u0020Glasses\u0020\u007C\u0020AC395F'"
                @click="openFullscreen($root)"
                class="max-h-screen-75 absolute inset-0 w-full cursor-pointer object-contain object-center"
                :class="{ 'cursor-pointer': !fullscreen }"
                width="830"
                height="415"
                :loading="active!==index ? 'lazy' : 'eager'"
                :src="fullscreen ? image.full : image.img"
                x-transition.opacity.duration.500ms=""
                x-show="active===index"
                @keydown.enter="openFullscreen($root)"
                :tabindex="fullscreen ? '-1' : '0'"
                :aria-describedby="fullscreen
                            ? ''
                            : 'main-image-description fullscreen-btn-label'
                        "
                :role="fullscreen ? 'img' : 'button'"
                alt="Amelia Salvini Glasses | AC395F"
                title="Amelia Salvini Glasses | AC395F"
                loading="eager"
                src="https://www.spex4less.com/media/mf_webp/jpeg/media/catalog/product/cache/5126638460848648518cefac96e6dd88/u/n/untitled-1_36__1_1.webp"
                tabindex="0"
                aria-describedby="main-image-description fullscreen-btn-label"
                role="button"
              />
              <div
                class="nonmobile absolute inset-0 hidden h-full w-full bg-white"
                :class="{ 'hidden': activeVideoType !== 'youtube' }"
                x-transition.opacity.duration.500ms=""
                x-show="
                         images[active].type === 'video' &amp;&amp; activeVideoType === 'youtube'
                     "
                style="display: none"
              >
                <div id="youtube-player" class="h-full w-full"></div>
              </div>
              <div
                class="absolute inset-0 hidden h-full w-full bg-white"
                :class="{ 'hidden': activeVideoType !== 'vimeo' }"
                x-transition.opacity.duration.500ms=""
                x-show="
                         images[active].type === 'video' &amp;&amp; activeVideoType === 'vimeo'
                     "
                style="display: none"
              >
                <div id="vimeo-player" class="h-full w-full"></div>
              </div>
            </div>
          </div>
          <div
            @resize.window.debounce="calcPageSize(); $nextTick(() => calcActive())"
          >
            <div
              id="thumbs"
              class="flex items-center"
              :class="{ 'fixed justify-center bottom-0 left-0 right-0 mx-6': fullscreen }"
              style="min-height: 100px"
              x-show="images.length > 1"
            >
              <button
                type="button"
                aria-label="Previous"
                tabindex="-1"
                class="pointer-events-none mr-4 hidden flex-none rounded-full text-black opacity-25 outline-none focus:outline-none"
                :class="{ 'opacity-25 pointer-events-none' : activeSlide === 0, 'hidden' : !isSlider }"
                aria-hidden="true"
                @click="scrollPrevious"
              >
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                  width="24"
                  height="24"
                  role="img"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="m15 19-7-7 7-7"
                  ></path>
                  <title>chevron-left</title>
                </svg>
              </button>
              <div
                class="js_thumbs_slides thumbs-wrapper js_slides snap relative flex w-full flex-nowrap overflow-auto md:px-1 xl:px-2"
                x-ref="jsThumbSlides"
                @scroll.debounce="calcPageSize(); calcActive()"
              >
                <template x-for="(image, index) in images" :key="index">
                  <div
                    class="js_thumbs_slide mb-2 mr-2 flex shrink-0 last:mr-0 lg:mr-4"
                  >
                    <button
                      type="button"
                      @click.prevent="setActive(index);"
                      class="hover:border-primary focus:border-primary block border border-gray-300"
                      :class="{'border-primary': active === index}"
                    >
                      <span class="sr-only"> View larger image </span>
                      <img
                        :src="image.thumb"
                        :alt="hyva.str('%1 thumbnail', image.caption) || 'Amelia\u0020Salvini\u0020Glasses\u0020\u007C\u0020AC395F\u0020thumbnail'"
                        :title="hyva.str('%1 thumbnail', image.caption) || 'Amelia\u0020Salvini\u0020Glasses\u0020\u007C\u0020AC395F\u0020thumbnail'"
                        width="90"
                        height="90"
                      />
                    </button>
                  </div>
                </template>
                <div
                  class="js_thumbs_slide mb-2 mr-2 flex shrink-0 last:mr-0 lg:mr-4"
                >
                  <button
                    type="button"
                    @click.prevent="setActive(index);"
                    class="hover:border-primary focus:border-primary block border border-gray-300"
                    :class="{'border-primary': active === index}"
                  >
                    <span class="sr-only"> View larger image </span>
                    <img
                      :src="image.thumb"
                      :alt="hyva.str('%1 thumbnail', image.caption) || 'Amelia\u0020Salvini\u0020Glasses\u0020\u007C\u0020AC395F\u0020thumbnail'"
                      :title="hyva.str('%1 thumbnail', image.caption) || 'Amelia\u0020Salvini\u0020Glasses\u0020\u007C\u0020AC395F\u0020thumbnail'"
                      width="90"
                      height="90"
                      src="https://www.spex4less.com/media/mf_webp/jpeg/media/catalog/product/cache/6f79d682222da838311c3be23e7c5358/u/n/untitled-1_36_.webp"
                      alt="Amelia Salvini Glasses | AC395F thumbnail"
                      title="Amelia Salvini Glasses | AC395F thumbnail"
                    />
                  </button>
                </div>
                <div
                  class="js_thumbs_slide mb-2 mr-2 flex shrink-0 last:mr-0 lg:mr-4"
                >
                  <button
                    type="button"
                    @click.prevent="setActive(index);"
                    class="hover:border-primary focus:border-primary border-primary block border border-gray-300"
                    :class="{'border-primary': active === index}"
                  >
                    <span class="sr-only"> View larger image </span>
                    <img
                      :src="image.thumb"
                      :alt="hyva.str('%1 thumbnail', image.caption) || 'Amelia\u0020Salvini\u0020Glasses\u0020\u007C\u0020AC395F\u0020thumbnail'"
                      :title="hyva.str('%1 thumbnail', image.caption) || 'Amelia\u0020Salvini\u0020Glasses\u0020\u007C\u0020AC395F\u0020thumbnail'"
                      width="90"
                      height="90"
                      src="https://www.spex4less.com/media/mf_webp/jpeg/media/catalog/product/cache/6f79d682222da838311c3be23e7c5358/u/n/untitled-1_36__1_1.webp"
                      alt="%1 thumbnail"
                      title="%1 thumbnail"
                    />
                  </button>
                </div>
              </div>
              <button
                type="button"
                x-show="images.length > 1"
                aria-label="Next"
                tabindex="-1"
                class="pointer-events-none ml-4 hidden flex-none rounded-full text-black opacity-25 outline-none focus:outline-none"
                :class="{ 'opacity-25 pointer-events-none' : activeSlide >= itemCount-pageSize, 'hidden' : !isSlider }"
                aria-hidden="true"
                @click="scrollNext"
                style=""
              >
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                  width="24"
                  height="24"
                  role="img"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="m9 5 7 7-7 7"
                  ></path>
                  <title>chevron-right</title>
                </svg>
              </button>
            </div>
          </div>
          <div class="absolute right-0 top-0 pr-4 pt-4">
            <button
              @click="closeFullScreen()"
              type="button"
              class="hidden p-3 text-gray-500 transition duration-150 ease-in-out hover:text-gray-600 focus:text-gray-600"
              :class="{ 'hidden': !fullscreen, 'block': fullscreen }"
              aria-label="Close fullscreen"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
                width="24"
                height="24"
                aria-hidden="true"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M6 18 18 6M6 6l12 12"
                ></path>
              </svg>
            </button>
          </div>
        </div>
      </div>
      <script>
        function initGallery() {
          let touchXDown, touchYDown;

          return {
            active: 0,
            videoData: {},
            activeVideoType: false,
            autoplayVideo: false,
            loopVideo: true,
            relatedVideos: false,
            vimeoPlayer: null,
            fullscreen: false,
            isSlider: false,
            initialImages: [
              {
                thumb:
                  "https:\/\/www.spex4less.com\/media\/mf_webp\/jpeg\/media\/catalog\/product\/cache\/6f79d682222da838311c3be23e7c5358\/u\/n\/untitled-1_36_.webp",
                img: "https:\/\/www.spex4less.com\/media\/mf_webp\/jpeg\/media\/catalog\/product\/cache\/5126638460848648518cefac96e6dd88\/u\/n\/untitled-1_36_.webp",
                full: "https:\/\/www.spex4less.com\/media\/mf_webp\/jpeg\/media\/catalog\/product\/cache\/27ca8be6872c5756dbe636052a828668\/u\/n\/untitled-1_36_.webp",
                caption: "Amelia Salvini Glasses | AC395F",
                position: "1",
                isMain: true,
                type: "image",
                videoUrl: null,
              },
            ],
            images: [
              {
                thumb:
                  "https:\/\/www.spex4less.com\/media\/mf_webp\/jpeg\/media\/catalog\/product\/cache\/6f79d682222da838311c3be23e7c5358\/u\/n\/untitled-1_36_.webp",
                img: "https:\/\/www.spex4less.com\/media\/mf_webp\/jpeg\/media\/catalog\/product\/cache\/5126638460848648518cefac96e6dd88\/u\/n\/untitled-1_36_.webp",
                full: "https:\/\/www.spex4less.com\/media\/mf_webp\/jpeg\/media\/catalog\/product\/cache\/27ca8be6872c5756dbe636052a828668\/u\/n\/untitled-1_36_.webp",
                caption: "Amelia Salvini Glasses | AC395F",
                position: "1",
                isMain: true,
                type: "image",
                videoUrl: null,
              },
            ],
            appendOnReceiveImages: true,
            activeSlide: 0,
            itemCount: 0,
            pageSize: 4,
            pageFillers: 0,
            focusTrapListener: null,
            init() {
              this.initActive();
              this.$nextTick(() => this.calcPageSize());
            },
            receiveImages(images) {
              if (this.appendOnReceiveImages) {
                const initialUrls = this.initialImages.map(
                  (image) => image.full,
                );
                const newImages = images.filter(
                  (image) => !initialUrls.includes(image.full),
                );
                this.images = [].concat(this.initialImages, newImages);
                this.setActive(
                  newImages.length ? this.initialImages.length : 0,
                );
              } else {
                this.images = images;
                this.setActive(0);
              }
            },
            resetGallery() {
              this.images = this.initialImages;
              this.setActive(0);
            },
            initActive() {
              let active = this.images.findIndex(function (image) {
                return image.isMain === true;
              });
              if (active === -1) {
                active = 0;
              }
              this.setActive(active);
            },
            setActive(index) {
              this.active = index;
              if (window.youtubePlayer) {
                window.youtubePlayer.stopVideo();
              }
              if (this.vimeoPlayer) {
                this.vimeoPlayer.contentWindow.postMessage(
                  JSON.stringify({ method: "pause" }),
                  "*",
                );
              }
              if (this.images[index].type === "video") {
                this.activateVideo();
              }
            },
            activateVideo() {
              const videoData = this.getVideoData();

              if (!videoData) {
                return;
              }

              this.activeVideoType = videoData.type;

              if (videoData.type === "youtube") {
                if (!window.youtubePlayer) {
                  this.initYoutubeAPI(videoData);
                } else {
                  window.youtubePlayer.loadVideoById(videoData.id);
                }
              } else if (videoData.type === "vimeo") {
                this.initVimeoVideo(videoData);
              }
            },
            getVideoData() {
              const videoUrl =
                this.images[this.active] && this.images[this.active].videoUrl;

              if (!videoUrl) {
                return;
              }

              let id,
                type,
                youtubeRegex,
                vimeoRegex,
                useYoutubeNoCookie = false;

              if (
                videoUrl.match(/youtube\.com|youtu\.be|youtube-nocookie.com/)
              ) {
                id = videoUrl
                  .replace(/^\/(embed\/|v\/)?/, "")
                  .replace(/\/.*/, "");
                type = "youtube";

                youtubeRegex =
                  /^.*(?:(?:youtu\.be\/|v\/|vi\/|u\/\w\/|embed\/)|(?:(?:watch)?\?v(?:i)?=|\&v(?:i)?=))([^#\&\?]*).*/;
                id = videoUrl.match(youtubeRegex)[1];

                if (videoUrl.match(/youtube-nocookie.com/)) {
                  useYoutubeNoCookie = true;
                }
              } else if (videoUrl.match(/vimeo\.com/)) {
                type = "vimeo";
                vimeoRegex = new RegExp(
                  [
                    "https?:\\/\\/(?:www\\.|player\\.)?vimeo.com\\/(?:channels\\/(?:\\w+\\/)",
                    "?|groups\\/([^\\/]*)\\/videos\\/|album\\/(\\d+)\\/video\\/|video\\/|)(\\d+)(?:$|\\/|\\?)",
                  ].join(""),
                );
                id = videoUrl.match(vimeoRegex)[3];
              }

              return id
                ? {
                    id: id,
                    type: type,
                    useYoutubeNoCookie: useYoutubeNoCookie,
                  }
                : false;
            },
            initYoutubeAPI(videoData) {
              if (document.getElementById("loadYoutubeAPI")) {
                return;
              }
              const params = {};
              const loadYoutubeAPI = document.createElement("script");
              loadYoutubeAPI.src = "https://www.youtube.com/iframe_api";
              loadYoutubeAPI.id = "loadYoutubeAPI";
              const firstScriptTag = document.getElementsByTagName("script")[0];
              firstScriptTag.parentNode.insertBefore(
                loadYoutubeAPI,
                firstScriptTag,
              );

              const host = videoData.useYoutubeNoCookie
                ? "https://www.youtube-nocookie.com"
                : "https://www.youtube.com";

              if (this.autoplayVideo) {
                params.autoplay = this.autoplayVideo;
              }
              if (!this.relatedVideos) {
                params.rel = 0;
              }
              const fireYoutubeAPI = document.createElement("script");
              fireYoutubeAPI.innerHTML = `function onYouTubeIframeAPIReady() {
                    window.youtubePlayer = new YT.Player('youtube-player', {
                        host: '${host}',
                        videoId: '${videoData.id}',
                        playerVars: ${JSON.stringify(params)},
                    });
                }`;
              firstScriptTag.parentNode.insertBefore(
                fireYoutubeAPI,
                firstScriptTag,
              );
            },
            initVimeoVideo(videoData) {
              let additionalParams = "",
                src;

              const timestamp = new Date().getTime();
              const vimeoContainer = document.getElementById("vimeo-player");
              const videoId = videoData.id;

              if (!vimeoContainer || !videoId) return;

              if (this.autoplayVideo) {
                additionalParams += "&autoplay=1";
              }

              if (this.loopVideo) {
                additionalParams += "&loop=1";
              }
              src =
                "https://player.vimeo.com/video/" +
                videoId +
                "?api=1&player_id=vimeo" +
                videoId +
                timestamp +
                additionalParams;
              vimeoContainer.innerHTML = `<iframe id="${
                "vimeo" + videoId + timestamp
              }"
                        src="${src}"
                        width="640" height="360"
                        webkitallowfullscreen
                        mozallowfullscreen
                        allowfullscreen
                        referrerPolicy="origin"
                        allow="autoplay"
                        class="object-center w-full h-full object-fit"
                     />`;

              this.vimeoPlayer = vimeoContainer.childNodes[0];
            },
            getSlider() {
              return this.$refs.jsThumbSlides;
            },
            calcPageSize() {
              const slider = this.getSlider();
              if (slider) {
                const slideEl = slider.querySelector(".js_thumbs_slide"),
                  marginRight = parseInt(
                    window.getComputedStyle(slideEl).marginRight,
                  );

                this.itemCount =
                  slider.querySelectorAll(".js_thumbs_slide").length;
                this.pageSize = Math.round(
                  slider.clientWidth / (slideEl.clientWidth + marginRight),
                );
                this.pageFillers =
                  this.pageSize * Math.ceil(this.itemCount / this.pageSize) -
                  this.itemCount;

                this.isSlider =
                  slider.clientWidth -
                    this.itemCount * (slideEl.clientWidth + marginRight) <
                  0;
              }
            },
            calcActive() {
              const slider = this.getSlider();
              if (slider) {
                const sliderItems = this.itemCount + this.pageFillers;
                const calculatedActiveSlide =
                  slider.scrollLeft / (slider.scrollWidth / sliderItems);
                this.activeSlide =
                  Math.round(calculatedActiveSlide / this.pageSize) *
                  this.pageSize;
              }
            },
            scrollPrevious() {
              this.scrollTo(this.activeSlide - this.pageSize);
            },
            scrollNext() {
              this.scrollTo(this.activeSlide + this.pageSize);
            },
            scrollTo(idx) {
              const slider = this.getSlider();
              if (slider) {
                const slideWidth =
                  slider.scrollWidth / (this.itemCount + this.pageFillers);
                slider.scrollLeft = Math.floor(slideWidth) * idx;
                this.activeSlide = idx;
              }
            },
            setActiveAndScrollTo(index) {
              this.setActive(index);
              if (this.isSlider) {
                this.scrollTo(index);
              }
            },
            eventListeners: {
              ["@keydown.window.escape"]() {
                this.closeFullScreen();
              },
              ["@update-gallery.window"](event) {
                this.receiveImages(event.detail);
              },
              ["@reset-gallery.window"](event) {
                this.resetGallery();
              },
            },
            focusTrapHandler: function (
              firstFocusableElement,
              lastFocusableElement,
              e,
            ) {
              const isTabPressed = e.key === "Tab" || e.keyCode === 9;

              if (!isTabPressed) {
                return;
              }

              e.shiftKey
                ? document.activeElement === firstFocusableElement &&
                  (lastFocusableElement.focus(), e.preventDefault())
                : document.activeElement === lastFocusableElement &&
                  (firstFocusableElement.focus(), e.preventDefault());
            },
            openFullscreen(node) {
              this.fullscreen = true;
              this.$nextTick(() => this.calcPageSize());

              const focusableElements =
                "button, [href], input, select, textarea";
              const focusableContent = Array.from(
                node.querySelectorAll(focusableElements),
              ).filter(
                (el) =>
                  (el.attributes.tabindex >= 0 || !el.attributes.tabindex) &&
                  el.style.display !== "none",
              );

              const firstFocusableElement =
                focusableContent.length > 0 ? focusableContent[0] : null;
              const lastFocusableElement =
                focusableContent.length > 0
                  ? focusableContent[focusableContent.length - 1]
                  : null;

              this.focusTrapListener = this.focusTrapHandler.bind(
                this,
                firstFocusableElement,
                lastFocusableElement,
              );

              document.addEventListener("keydown", this.focusTrapListener);
            },
            closeFullScreen() {
              if (this.fullscreen) {
                this.$refs.galleryMainImage.focus();
              }
              this.fullscreen = false;
              this.$nextTick(() => this.calcPageSize());

              document.removeEventListener("keydown", this.focusTrapListener);
            },
            handleTouchStart(event) {
              if (this.images.length <= 1) {
                return;
              }

              const firstTouch = event.touches[0];

              touchXDown = firstTouch.clientX;
              touchYDown = firstTouch.clientY;
            },
            handleTouchMove(event) {
              if (this.images.length <= 1 || !touchXDown || !touchYDown) {
                return;
              }

              const xDiff = touchXDown - event.touches[0].clientX;
              const yDiff = touchYDown - event.touches[0].clientY;

              if (Math.abs(xDiff) > Math.abs(yDiff)) {
                const newIndex =
                  xDiff > 0 ? this.getNextIndex() : this.getPreviousIndex();
                this.setActiveAndScrollTo(newIndex);
              }
              touchXDown = touchYDown = null;
            },
            getPreviousIndex() {
              return this.active > 0 ? this.active - 1 : this.itemCount - 1;
            },
            getNextIndex() {
              return this.active + 1 === this.itemCount ? 0 : this.active + 1;
            },
          };
        }
      </script>
      <div class="mb-6 w-full bg-white px-4">
        <div class="my-2 flex">
          <div
            class="trustpilot-widget"
            data-locale="en-GB"
            data-template-id="54d39695764ea907c0f34825"
            data-businessunit-id="4be440aa000064000508db50"
            data-style-height="24px"
            data-style-width="100%"
            data-theme="light"
            data-sku="Amelia Salvini Glasses | AC395F"
            data-name="Amelia Salvini Glasses | AC395F"
            data-no-reviews="collapse"
            data-scroll-to-list="true"
            data-style-alignment="left"
            style="position: relative"
          >
            <iframe
              title="Customer reviews powered by Trustpilot"
              loading="auto"
              src="https://widget.trustpilot.com/trustboxes/54d39695764ea907c0f34825/index.html?templateId=54d39695764ea907c0f34825&amp;businessunitId=4be440aa000064000508db50#locale=en-GB&amp;styleHeight=24px&amp;styleWidth=100%25&amp;theme=light&amp;sku=Amelia%20Salvini%20Glasses%20%7C%20AC395F&amp;name=Amelia%20Salvini%20Glasses%20%7C%20AC395F&amp;noReviews=collapse&amp;scrollToList=true&amp;styleAlignment=left"
              style="
                position: relative;
                height: 24px;
                width: 100%;
                border-style: none;
                display: none;
                overflow: hidden;
              "
            ></iframe>
          </div>
        </div>
        <div class="flex flex-col items-end sm:flex-row">
          <div role="group" aria-label="Price">
            <script>
              function initPrice39097() {
                const regularPriceInclTaxKey = "oldPrice",
                  regularPriceExclTaxKey = "baseOldPrice",
                  finalPriceInclTaxKey = "finalPrice",
                  finalPriceExclTaxKey = "basePrice";

                function calculateCustomOptionPrices(
                  activeCustomOptions,
                  customOptionPrices,
                ) {
                  return activeCustomOptions.reduce(
                    (priceAccumulator, activeCustomOptionId) => {
                      const customOptionPrice =
                        customOptionPrices[activeCustomOptionId];
                      if (customOptionPrice) {
                        return (
                          Number.parseFloat(priceAccumulator) +
                          Number.parseFloat(customOptionPrice)
                        );
                      }
                      return priceAccumulator;
                    },
                    0,
                  );
                }

                return {
                  regularPriceKey: regularPriceInclTaxKey,
                  finalPriceKey: finalPriceInclTaxKey,
                  activeProductsPriceData: false,
                  initialFinalPrice: 49.97,
                  calculatedFinalPrice: false,
                  calculatedFinalPriceWithCustomOptions: false,
                  initialTierPrices: [],
                  showRegularPriceLabel: false,
                  customOptionPrices: [],
                  activeCustomOptions: [],
                  qty: 1,
                  updateCustomOptionActive(data) {
                    let activeCustomOptions = this.activeCustomOptions;
                    const customOptionId = data.customOptionId;

                    if (data.active) {
                      if (!activeCustomOptions.includes(customOptionId)) {
                        activeCustomOptions.push(data.customOptionId);
                      }
                    } else {
                      if (
                        customOptionId &&
                        activeCustomOptions.includes(customOptionId)
                      ) {
                        let index = activeCustomOptions.indexOf(customOptionId);
                        activeCustomOptions.splice(index, 1);
                      }
                    }
                    this.calculateFinalPriceWithCustomOptions();
                  },
                  updateCustomOptionPrices(prices, basePrices) {
                    if (prices) {
                      this.customOptionPrices = prices;
                    }

                    this.calculateFinalPriceWithCustomOptions();
                  },
                  calculateFinalPrice() {
                    const findApplicableTierPrice = (initialPrice, withTax) => {
                      if (
                        this.activeProductsPriceData &&
                        this.activeProductsPriceData.tierPrices
                      ) {
                        const key = withTax ? "price" : "basePrice";
                        return this.activeProductsPriceData.tierPrices.reduce(
                          (acc, tierPrice) => {
                            if (
                              this.qty >= tierPrice.qty &&
                              tierPrice[key] < acc
                            ) {
                              return tierPrice[key];
                            }
                            return acc;
                          },
                          this.activeProductsPriceData[
                            withTax
                              ? finalPriceInclTaxKey
                              : finalPriceExclTaxKey
                          ].amount,
                        );
                      } else {
                        const key = withTax
                          ? "price_incl_tax"
                          : "price_excl_tax";
                        return Object.values(this.initialTierPrices).reduce(
                          (acc, tierPrice) => {
                            if (
                              this.qty >= tierPrice.price_qty &&
                              tierPrice[key] < acc
                            ) {
                              return tierPrice[key];
                            }
                            return acc;
                          },
                          initialPrice,
                        );
                      }
                    };

                    this.calculatedFinalPrice = findApplicableTierPrice(
                      this.initialFinalPrice,
                      true,
                    );
                    window.dispatchEvent(
                      new CustomEvent("update-product-final-price", {
                        detail: this.calculatedFinalPrice,
                      }),
                    );
                  },
                  calculatePriceLabelVisibility() {
                    this.showRegularPriceLabel =
                      this.calculatedFinalPrice ===
                        this.activeProductsPriceData[this.regularPriceKey]
                          .amount &&
                      this.activeProductsPriceData.isMinimalPrice;
                  },
                  calculateFinalPriceWithCustomOptions() {
                    const finalPrice =
                      this.calculatedFinalPrice || this.initialFinalPrice;
                    this.calculatedFinalPriceWithCustomOptions =
                      finalPrice + this.getCustomOptionPrice();
                  },
                  getCustomOptionPrice() {
                    return calculateCustomOptionPrices(
                      this.activeCustomOptions,
                      this.customOptionPrices,
                    );
                  },
                  getFormattedFinalPrice() {
                    return hyva.formatPrice(
                      this.calculatedFinalPriceWithCustomOptions ||
                        this.calculatedFinalPrice ||
                        this.initialFinalPrice,
                    );
                  },
                  isPriceHidden() {
                    const finalPrice =
                      this.calculatedFinalPriceWithCustomOptions ||
                      this.calculatedFinalPrice ||
                      this.initialFinalPrice;
                    return false && finalPrice === 0;
                  },
                  eventListeners: {
                    ["@update-prices-39097.window"](event) {
                      this.activeProductsPriceData = event.detail;

                      this.calculateFinalPrice();
                      this.calculateFinalPriceWithCustomOptions();
                      this.calculatePriceLabelVisibility();
                    },
                    ["@update-qty-39097.window"](event) {
                      this.qty = event.detail;
                      this.calculateFinalPrice();
                      this.calculateFinalPriceWithCustomOptions();
                    },
                    ["@update-custom-option-active.window"](event) {
                      this.updateCustomOptionActive(event.detail);
                    },
                    ["@update-custom-option-prices.window"](event) {
                      this.updateCustomOptionPrices(event.detail);
                    },
                  },
                };
              }
            </script>
            <div
              x-data="initPrice39097()"
              x-bind="eventListeners"
              class="price-box price-final_price"
            >
              <div
                itemprop="offers"
                itemscope=""
                itemtype="http://schema.org/Offer"
              >
                <meta itemprop="price" content="49.97" />
                <meta itemprop="priceCurrency" content="GBP" />
                <link
                  itemprop="availability"
                  href="https://schema.org/InStock"
                />
              </div>
              <template
                x-if="!activeProductsPriceData &amp;&amp; !isPriceHidden()"
              >
                <div class="price-container">
                  <div class="final-price inline-block">
                    <span
                      id="product-price-39097"
                      class="price-wrapper title-font text-3xl font-bold text-gray-900"
                    >
                      <span class="price" x-html="getFormattedFinalPrice()">
                        <span class="price">£49.97</span>
                      </span>
                    </span>
                  </div>
                </div>
              </template>
              <template
                x-if="activeProductsPriceData &amp;&amp;
        activeProductsPriceData.oldPrice &amp;&amp;
        activeProductsPriceData[finalPriceKey].amount < activeProductsPriceData[regularPriceKey].amount
    "
              >
                <div class="old-price mr-2 flex">
                  <span
                    id="product-price-39097"
                    class="price-wrapper title-font text-xl text-gray-500 line-through"
                  >
                    <span
                      class="price"
                      x-html="hyva.formatPrice(activeProductsPriceData[regularPriceKey].amount + getCustomOptionPrice())"
                    ></span>
                  </span>
                </div>
              </template>
              <template x-if="activeProductsPriceData">
                <div class="final-price inline-block">
                  <span
                    id="product-price-39097"
                    class="price-wrapper title-font text-3xl font-bold text-gray-900"
                  >
                    <span
                      class="price"
                      x-html="getFormattedFinalPrice()"
                    ></span>
                  </span>
                </div>
              </template>
              <div class="final-price inline-block">
                <span
                  id="product-price-39097"
                  class="price-wrapper title-font text-3xl font-bold text-gray-900"
                >
                  <span class="price" x-html="getFormattedFinalPrice()"
                    >£49.97</span
                  >
                </span>
              </div>
            </div>
          </div>
          <div class="ml-auto mt-4 flex sm:mt-0">
            <script>
              function initQtyField() {
                function findPathParam(key) {
                  // get all path pairs after BASE_URL/front_name/action_path/action
                  const baseUrl =
                    (BASE_URL.substring(0, 2) === "//" ? "http:" : "") +
                    BASE_URL;
                  const baseUrlParts = new URL(baseUrl).pathname
                    .replace(/\/$/, "")
                    .split("/");
                  const pathParts = window.location.pathname
                    .split("/")
                    .slice(baseUrlParts.length + 3);
                  for (let i = 0; i < pathParts.length; i += 2) {
                    if (pathParts[i] === key && pathParts.length > i) {
                      return pathParts[i + 1];
                    }
                  }
                }

                return {
                  qty: 1,
                  itemId:
                    new URLSearchParams(window.location.search).get("id") ||
                    findPathParam("id"),
                  productId: "39097",
                  onGetCartData: function onGetCartData(data, $dispatch) {
                    const cart = data && data.data && data.data.cart;
                    if (this.itemId && cart && cart.items) {
                      const cartItem = cart.items.find((item) => {
                        return (
                          item.item_id === this.itemId &&
                          item.product_id === this.productId
                        );
                      });
                      if (cartItem && cartItem.qty) {
                        this.qty = cartItem.qty;
                        $dispatch("update-qty-" + this.productId, this.qty);
                      }
                    }
                  },
                };
              }
            </script>
            <div x-data="initQtyField()" class="">
              <div class="mr-2">
                <input
                  name="qty"
                  @private-content-loaded.window="onGetCartData($event.detail, $dispatch)"
                  id="qty[39097]"
                  form="product_addtocart_form"
                  type="hidden"
                  pattern="[0-9]{0,5}"
                  inputmode="numeric"
                  min="1"
                  max="10000"
                  :value="qty"
                  class="form-input w-20 px-2 py-2 text-center invalid:ring-2 invalid:ring-red-500"
                  x-model.number="qty"
                  @change="$dispatch('update-qty-39097', qty)"
                  value="1"
                />
              </div>
            </div>
          </div>
        </div>
        <meta itemprop="brand" content="salvini" />
        <meta itemprop="sku" content="Amelia Salvini Glasses | AC395F" />
        <meta
          itemprop="url"
          content="https://www.spex4less.com/glasses/amelia-glasses"
        />
        <form
          method="post"
          action="https://www.spex4less.com/checkout/cart/add/uenc/aHR0cHM6Ly93d3cuc3BleDRsZXNzLmNvbS9nbGFzc2VzL2FtZWxpYS1nbGFzc2Vz/product/39097/"
          class="mb-6"
          id="product_addtocart_form"
        >
          <input type="hidden" name="product" value="39097" />
          <input type="hidden" name="selected_configurable_option" value="" />
          <input
            type="hidden"
            name="related_product"
            id="related-products-field"
            value=""
          />
          <input type="hidden" name="item" value="39097" />
          <input name="form_key" type="hidden" value="CfJiZjJ5PeJ2gLDh" />
          <script type="text/javascript">
            function updateProductOptionsFromBox_39097() {
              let template = '[name="super_attribute[#]"]';
              let urlParamToAttrCode = {
                size: "a01_size_option",
                color: "color",
              };

              const urlParams = new URLSearchParams(window.location.search);
              let found = {};

              Object.keys(urlParamToAttrCode).forEach((key) => {
                let value = urlParams.get(key);
                if (value) {
                  found[urlParamToAttrCode[key]] = value;
                }
              });

              let formData = new FormData();
              formData.append("form_key", hyva.getCookie("form_key"));

              if (Object.keys(found).length) {
                formData.append("from_url", JSON.stringify(found));
              }

              fetch(
                "https://www.spex4less.com/templatemods/ajax/checkproductconfiguration/product_id/39097" +
                  "/form_key/" +
                  hyva.getCookie("form_key"),
                {
                  method: "POST",
                  body: formData,
                },
              )
                .then((response) => {
                  if (response.ok && 200 === response.status) {
                    return response.json();
                  } else {
                    return Promise.reject(new Error("Something went wrong."));
                  }
                })
                .then((data) => {
                  if (!data.error) {
                    if (data.config.partially_configured) {
                      let form = document.getElementById(
                        "product_addtocart_form",
                      );
                      let attributes = data.config.super_attribute;

                      Object.keys(attributes).forEach((key) => {
                        let radios = form.querySelectorAll(
                          template.replace("#", key),
                        );
                        radios = Array.from(radios);

                        radios.every((item) => {
                          if (item.value === attributes[key]) {
                            item.checked = true;
                            item.dispatchEvent(new CustomEvent("change"));
                            return false;
                          }
                          return true;
                        });
                      });
                    }
                  } else {
                    return Promise.reject(new Error("Something went wrong."));
                  }
                })
                .catch((reason) => {
                  throw reason;
                });
            }
          </script>
          <script>
            function initConfigurableSwatchOptions_39097() {
              const configurableOptionsComponent = initConfigurableOptions(
                "39097",
                {
                  attributes: {
                    93: {
                      id: "93",
                      code: "color",
                      label: "Colour",
                      options: [
                        { id: "4", label: "Brown", products: ["39096"] },
                      ],
                      position: "0",
                    },
                    156: {
                      id: "156",
                      code: "a01_size_option",
                      label: "Size Option",
                      options: [
                        { id: "829", label: "54-15-145", products: ["39096"] },
                      ],
                      position: "1",
                    },
                  },
                  template: "\u00a3<%- data.price %>",
                  currencyFormat: "\u00a3%s",
                  optionPrices: {
                    39096: {
                      baseOldPrice: { amount: 41.641665666667 },
                      oldPrice: { amount: 49.97 },
                      basePrice: { amount: 41.641665666667 },
                      finalPrice: { amount: 49.97 },
                      tierPrices: [],
                      msrpPrice: { amount: 0 },
                    },
                  },
                  priceFormat: {
                    pattern: "\u00a3%s",
                    precision: 2,
                    requiredPrecision: 2,
                    decimalSymbol: ".",
                    groupSymbol: ",",
                    groupLength: 3,
                    integerRequired: false,
                  },
                  prices: {
                    baseOldPrice: { amount: 41.641665666667 },
                    oldPrice: { amount: 49.97 },
                    basePrice: { amount: 41.641665666667 },
                    finalPrice: { amount: 49.97 },
                  },
                  productId: "39097",
                  chooseText: "Choose an Option...",
                  images: {
                    39096: [
                      {
                        thumb:
                          "https:\/\/www.spex4less.com\/media\/mf_webp\/jpeg\/media\/catalog\/product\/cache\/6f79d682222da838311c3be23e7c5358\/u\/n\/untitled-1_36__1_1.webp",
                        img: "https:\/\/www.spex4less.com\/media\/mf_webp\/jpeg\/media\/catalog\/product\/cache\/5126638460848648518cefac96e6dd88\/u\/n\/untitled-1_36__1_1.webp",
                        full: "https:\/\/www.spex4less.com\/media\/mf_webp\/jpeg\/media\/catalog\/product\/cache\/27ca8be6872c5756dbe636052a828668\/u\/n\/untitled-1_36__1_1.webp",
                        caption: null,
                        position: "1",
                        isMain: true,
                        type: "image",
                        videoUrl: null,
                      },
                    ],
                  },
                  index: { 39096: { 93: "4", 156: "829" } },
                  salable: [],
                  canDisplayShowOutOfStockStatus: false,
                  supplier_colour_data: {
                    colour_attribute_id: 93,
                    mapping: { 39096: null },
                  },
                },
              );
              const swatchOptionsComponent = initSwatchOptions({
                93: {
                  4: { type: "1", value: "#662505", label: "Brown" },
                  additional_data:
                    '{"swatch_input_type":"visual","update_product_preview_image":"1","use_product_image_for_swatch":"0"}',
                },
              });

              return Object.assign(
                configurableOptionsComponent,
                swatchOptionsComponent,
              );
            }
          </script>
          <style>
            .customized-attribute-option-label {
              padding-left: 12px;
              padding-right: 12px;
              padding-top: 5px;
              padding-bottom: 5px;
              border: 1px solid rgba(0, 0, 0, 0.2);
              display: flex;
              justify-content: center;
            }

            .customized-attribute-option-label.selected {
              border: 1px solid rgba(0, 0, 0, 0.6);
              background-color: rgba(0, 0, 0, 0.04);
            }
          </style>
          <div
            x-data="initConfigurableSwatchOptions_39097()"
            x-init="init(); initShowSwatchesIntersect(); $nextTick(updateProductOptionsFromBox_39097)"
            @private-content-loaded.window="onGetCartData($event.detail.data)"
            class="relative mb-6 ml-2"
          >
            <h2 class="title-font mb-4 text-xl font-medium text-gray-900">
              Product Options:
            </h2>
            <div>
              <div class="swatch-attribute min-h-14 color">
                <template x-if="showSwatches">
                  <div
                    class="flex w-full flex-col items-center border-gray-300 py-4 sm:flex-row sm:py-1"
                  >
                    <label
                      class="label product-option-label w-full text-left text-gray-700 sm:w-1/2"
                      id="attribute-label-39097-93"
                      aria-hidden="true"
                    >
                      <span>Colour</span>
                      <span
                        class="ml-2 font-bold text-gray-900"
                        x-text="getSwatchText(93, selectedValues[93])"
                      ></span>
                    </label>
                    <div
                      class="product-option-values w-full text-left text-gray-900 sm:ml-2 sm:w-1/2"
                    >
                      <div
                        class="swatch-attribute-options -mx-4 flex items-center space-x-4"
                        role="radiogroup"
                        aria-label="Colour"
                      >
                        <template
                          x-for="(item, index) in optionConfig.attributes[93].options"
                          :key="item.id"
                        >
                          <div x-id="['attribute-option-39097-'+item.id]">
                            <template
                              x-if="optionIsEnabled(93, item.id) &amp;&amp; optionIsActive(93, item.id)"
                            >
                              <label
                                :for="$id('attribute-option-39097-'+item.id)"
                                class="swatch-option bg-container-lighter product-option-value-label relative cursor-pointer select-none shadow-sm"
                                :class="{
                'border-container-lighter ring ring-primary/50':
                    (selectedValues[93] === item.id),
                'border-container-darker':
                    (selectedValues[93] !== item.id),
                'w-6 h-6' : !isTextSwatch(93, item.id),
                'border-container-lighter ring ring-primary/75' : focusedLabel === item.id
            }"
                                :style="getSwatchBackgroundStyle('93',item.id)"
                              >
                                <input
                                  :id="$id('attribute-option-39097-'+item.id)"
                                  :value="item.id"
                                  name="super_attribute[93]"
                                  type="radio"
                                  class="product-option-value-input absolute inline-block border-0 p-0 focus:border-0 focus:ring-0"
                                  style="z-index: -1"
                                  x-on:blur="blurLabel()"
                                  x-on:change="changeOption(93, $event.target.value)"
                                  x-on:click="clearOptionIfActive(93, item.id)"
                                  x-model="selectedValues[93]"
                                  :required="getAllowedAttributeOptions(93).filter(
                    attributeOption => selectedValues[attributeOption]
                ).length === 0"
                                  :aria-label="getSwatchText(93, item.id)"
                                  aria-describedby="attribute-label-39097-93"
                                />
                                <template x-if="isTextSwatch(93, item.id)">
                                  <div
                                    x-html="getSwatchText(93, item.id)"
                                    class="pointer-events-none select-none whitespace-nowrap"
                                    aria-hidden="true"
                                  ></div>
                                </template>
                              </label>
                            </template>
                            <template
                              x-if="optionIsEnabled(93, item.id) &amp;&amp; !optionIsActive(93, item.id)"
                            >
                              <div
                                class="border-container-darker swatch-option bg-container-lighter relative cursor-pointer select-none border-2 opacity-50 shadow-sm"
                                :class="{
                                                        'w-6 h-6' : !isTextSwatch(93, item.id),
                                                    }"
                                :style="getSwatchBackgroundStyle('93',item.id)"
                              >
                                <div
                                  x-html="getSwatchText(93, item.id)"
                                  class="whitespace-nowrap"
                                  :class="{ 'sr-only' : !isTextSwatch(93, item.id) }"
                                ></div>
                                <svg
                                  class="absolute inset-0 h-full w-full bg-white/25 text-gray-500"
                                >
                                  <line
                                    x1="0"
                                    y1="100%"
                                    x2="100%"
                                    y2="0"
                                    class="stroke-current stroke-1"
                                  ></line>
                                </svg>
                              </div>
                            </template>
                          </div>
                        </template>
                      </div>
                    </div>
                  </div>
                </template>
                <div
                  class="flex w-full flex-col items-center border-gray-300 py-4 sm:flex-row sm:py-1"
                >
                  <label
                    class="label product-option-label w-full text-left text-gray-700 sm:w-1/2"
                    id="attribute-label-39097-93"
                    aria-hidden="true"
                  >
                    <span>Colour</span>
                    <span
                      class="ml-2 font-bold text-gray-900"
                      x-text="getSwatchText(93, selectedValues[93])"
                      >Brown</span
                    >
                  </label>
                  <div
                    class="product-option-values w-full text-left text-gray-900 sm:ml-2 sm:w-1/2"
                  >
                    <div
                      class="swatch-attribute-options -mx-4 flex items-center space-x-4"
                      role="radiogroup"
                      aria-label="Colour"
                    >
                      <template
                        x-for="(item, index) in optionConfig.attributes[93].options"
                        :key="item.id"
                      >
                        <div x-id="['attribute-option-39097-'+item.id]">
                          <template
                            x-if="optionIsEnabled(93, item.id) &amp;&amp; optionIsActive(93, item.id)"
                          >
                            <label
                              :for="$id('attribute-option-39097-'+item.id)"
                              class="swatch-option bg-container-lighter product-option-value-label relative cursor-pointer select-none shadow-sm"
                              :class="{
                'border-container-lighter ring ring-primary/50':
                    (selectedValues[93] === item.id),
                'border-container-darker':
                    (selectedValues[93] !== item.id),
                'w-6 h-6' : !isTextSwatch(93, item.id),
                'border-container-lighter ring ring-primary/75' : focusedLabel === item.id
            }"
                              :style="getSwatchBackgroundStyle('93',item.id)"
                            >
                              <input
                                :id="$id('attribute-option-39097-'+item.id)"
                                :value="item.id"
                                name="super_attribute[93]"
                                type="radio"
                                class="product-option-value-input absolute inline-block border-0 p-0 focus:border-0 focus:ring-0"
                                style="z-index: -1"
                                x-on:blur="blurLabel()"
                                x-on:change="changeOption(93, $event.target.value)"
                                x-on:click="clearOptionIfActive(93, item.id)"
                                x-model="selectedValues[93]"
                                :required="getAllowedAttributeOptions(93).filter(
                    attributeOption => selectedValues[attributeOption]
                ).length === 0"
                                :aria-label="getSwatchText(93, item.id)"
                                aria-describedby="attribute-label-39097-93"
                              />
                              <template x-if="isTextSwatch(93, item.id)">
                                <div
                                  x-html="getSwatchText(93, item.id)"
                                  class="pointer-events-none select-none whitespace-nowrap"
                                  aria-hidden="true"
                                ></div>
                              </template>
                            </label>
                          </template>
                          <template
                            x-if="optionIsEnabled(93, item.id) &amp;&amp; !optionIsActive(93, item.id)"
                          >
                            <div
                              class="border-container-darker swatch-option bg-container-lighter relative cursor-pointer select-none border-2 opacity-50 shadow-sm"
                              :class="{
                                                        'w-6 h-6' : !isTextSwatch(93, item.id),
                                                    }"
                              :style="getSwatchBackgroundStyle('93',item.id)"
                            >
                              <div
                                x-html="getSwatchText(93, item.id)"
                                class="whitespace-nowrap"
                                :class="{ 'sr-only' : !isTextSwatch(93, item.id) }"
                              ></div>
                              <svg
                                class="absolute inset-0 h-full w-full bg-white/25 text-gray-500"
                              >
                                <line
                                  x1="0"
                                  y1="100%"
                                  x2="100%"
                                  y2="0"
                                  class="stroke-current stroke-1"
                                ></line>
                              </svg>
                            </div>
                          </template>
                        </div>
                      </template>
                      <div x-id="['attribute-option-39097-'+item.id]">
                        <template
                          x-if="optionIsEnabled(93, item.id) &amp;&amp; optionIsActive(93, item.id)"
                        >
                          <label
                            :for="$id('attribute-option-39097-'+item.id)"
                            class="swatch-option bg-container-lighter product-option-value-label relative cursor-pointer select-none shadow-sm"
                            :class="{
                'border-container-lighter ring ring-primary/50':
                    (selectedValues[93] === item.id),
                'border-container-darker':
                    (selectedValues[93] !== item.id),
                'w-6 h-6' : !isTextSwatch(93, item.id),
                'border-container-lighter ring ring-primary/75' : focusedLabel === item.id
            }"
                            :style="getSwatchBackgroundStyle('93',item.id)"
                          >
                            <input
                              :id="$id('attribute-option-39097-'+item.id)"
                              :value="item.id"
                              name="super_attribute[93]"
                              type="radio"
                              class="product-option-value-input absolute inline-block border-0 p-0 focus:border-0 focus:ring-0"
                              style="z-index: -1"
                              x-on:blur="blurLabel()"
                              x-on:change="changeOption(93, $event.target.value)"
                              x-on:click="clearOptionIfActive(93, item.id)"
                              x-model="selectedValues[93]"
                              :required="getAllowedAttributeOptions(93).filter(
                    attributeOption => selectedValues[attributeOption]
                ).length === 0"
                              :aria-label="getSwatchText(93, item.id)"
                              aria-describedby="attribute-label-39097-93"
                            />
                            <template x-if="isTextSwatch(93, item.id)">
                              <div
                                x-html="getSwatchText(93, item.id)"
                                class="pointer-events-none select-none whitespace-nowrap"
                                aria-hidden="true"
                              ></div>
                            </template>
                          </label> </template
                        ><label
                          :for="$id('attribute-option-39097-'+item.id)"
                          class="swatch-option bg-container-lighter product-option-value-label border-container-lighter ring-primary/50 relative h-6 w-6 cursor-pointer select-none shadow-sm ring"
                          :class="{
                'border-container-lighter ring ring-primary/50':
                    (selectedValues[93] === item.id),
                'border-container-darker':
                    (selectedValues[93] !== item.id),
                'w-6 h-6' : !isTextSwatch(93, item.id),
                'border-container-lighter ring ring-primary/75' : focusedLabel === item.id
            }"
                          :style="getSwatchBackgroundStyle('93',item.id)"
                          for="attribute-option-39097-4-1"
                          style="background-color: #662505"
                        >
                          <input
                            :id="$id('attribute-option-39097-'+item.id)"
                            :value="item.id"
                            name="super_attribute[93]"
                            type="radio"
                            class="product-option-value-input absolute inline-block border-0 p-0 focus:border-0 focus:ring-0"
                            style="z-index: -1"
                            x-on:blur="blurLabel()"
                            x-on:change="changeOption(93, $event.target.value)"
                            x-on:click="clearOptionIfActive(93, item.id)"
                            x-model="selectedValues[93]"
                            :required="getAllowedAttributeOptions(93).filter(
                    attributeOption => selectedValues[attributeOption]
                ).length === 0"
                            :aria-label="getSwatchText(93, item.id)"
                            aria-describedby="attribute-label-39097-93"
                            id="attribute-option-39097-4-1"
                            value="4"
                            required="required"
                            aria-label="Brown"
                          />
                          <template x-if="isTextSwatch(93, item.id)">
                            <div
                              x-html="getSwatchText(93, item.id)"
                              class="pointer-events-none select-none whitespace-nowrap"
                              aria-hidden="true"
                            ></div>
                          </template>
                        </label>
                        <template
                          x-if="optionIsEnabled(93, item.id) &amp;&amp; !optionIsActive(93, item.id)"
                        >
                          <div
                            class="border-container-darker swatch-option bg-container-lighter relative cursor-pointer select-none border-2 opacity-50 shadow-sm"
                            :class="{
                                                        'w-6 h-6' : !isTextSwatch(93, item.id),
                                                    }"
                            :style="getSwatchBackgroundStyle('93',item.id)"
                          >
                            <div
                              x-html="getSwatchText(93, item.id)"
                              class="whitespace-nowrap"
                              :class="{ 'sr-only' : !isTextSwatch(93, item.id) }"
                            ></div>
                            <svg
                              class="absolute inset-0 h-full w-full bg-white/25 text-gray-500"
                            >
                              <line
                                x1="0"
                                y1="100%"
                                x2="100%"
                                y2="0"
                                class="stroke-current stroke-1"
                              ></line>
                            </svg>
                          </div>
                        </template>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="flex w-full flex-col items-center py-2 sm:flex-row">
                <label
                  class="label w-full text-left text-gray-700 sm:w-1/2"
                  id="attribute-label-39097-156"
                >
                  <span> Size Option </span>
                  <span
                    class="selected-label ml-2 font-bold text-gray-900"
                    x-text="getSwatchText(156, selectedValues[156])"
                    >54-15-145</span
                  >
                </label>
                <div class="flex flex-row flex-wrap gap-3 sm:ml-2">
                  <template
                    x-for="(item, index) in getAllowedAttributeOptions(156)"
                    :key="item.id"
                  >
                    <div x-id="['attribute-option-39097-'+item.id]">
                      <template
                        x-if="optionIsEnabled(156, item.id) &amp;&amp; optionIsActive(156, item.id)"
                      >
                        <label
                          :for="$id('attribute-option-39097-'+item.id)"
                          class="customized-attribute-option-label relative cursor-pointer select-none"
                          :class="selectedValues[156] === item.id ? 'selected' : ''"
                        >
                          <input
                            type="radio"
                            name="super_attribute[156]"
                            class="product-option-value-input absolute bottom-0 inline-block border-0 p-0 focus:border-0 focus:ring-0"
                            style="z-index: -1"
                            :id="$id('attribute-option-39097-'+item.id)"
                            :value="item.id"
                            x-on:change="changeOption(156, $event.target.value)"
                            x-on:click="clearOptionIfActive(156, item.id)"
                            x-model="selectedValues[156]"
                            :required="getAllowedAttributeOptions(156).filter(attributeOption => selectedValues[attributeOption]).length === 0"
                          />
                          <span x-html="item.label"></span>
                        </label>
                      </template>
                    </div>
                  </template>
                  <div x-id="['attribute-option-39097-'+item.id]">
                    <template
                      x-if="optionIsEnabled(156, item.id) &amp;&amp; optionIsActive(156, item.id)"
                    >
                      <label
                        :for="$id('attribute-option-39097-'+item.id)"
                        class="customized-attribute-option-label relative cursor-pointer select-none"
                        :class="selectedValues[156] === item.id ? 'selected' : ''"
                      >
                        <input
                          type="radio"
                          name="super_attribute[156]"
                          class="product-option-value-input absolute bottom-0 inline-block border-0 p-0 focus:border-0 focus:ring-0"
                          style="z-index: -1"
                          :id="$id('attribute-option-39097-'+item.id)"
                          :value="item.id"
                          x-on:change="changeOption(156, $event.target.value)"
                          x-on:click="clearOptionIfActive(156, item.id)"
                          x-model="selectedValues[156]"
                          :required="getAllowedAttributeOptions(156).filter(attributeOption => selectedValues[attributeOption]).length === 0"
                        />
                        <span x-html="item.label"></span>
                      </label> </template
                    ><label
                      :for="$id('attribute-option-39097-'+item.id)"
                      class="customized-attribute-option-label selected relative cursor-pointer select-none"
                      :class="selectedValues[156] === item.id ? 'selected' : ''"
                      for="attribute-option-39097-829-1"
                    >
                      <input
                        type="radio"
                        name="super_attribute[156]"
                        class="product-option-value-input absolute bottom-0 inline-block border-0 p-0 focus:border-0 focus:ring-0"
                        style="z-index: -1"
                        :id="$id('attribute-option-39097-'+item.id)"
                        :value="item.id"
                        x-on:change="changeOption(156, $event.target.value)"
                        x-on:click="clearOptionIfActive(156, item.id)"
                        x-model="selectedValues[156]"
                        :required="getAllowedAttributeOptions(156).filter(attributeOption => selectedValues[attributeOption]).length === 0"
                        id="attribute-option-39097-829-1"
                        value="829"
                        required="required"
                      />
                      <span x-html="item.label">54-15-145</span>
                    </label>
                  </div>
                </div>
              </div>
              <p class="underline">New help choosing your size?</p>
            </div>
            <template x-if="isTooltipVisible()">
              <div
                class="pointer-events-none absolute select-none"
                :style="getTooltipPosition()"
              >
                <div class="shadow-lg">
                  <div
                    class="min-w-20 absolute left-0 top-0 z-10 -mt-6 -translate-x-1/2 -translate-y-full transform rounded-lg bg-white p-2 text-center text-sm leading-tight text-black shadow-lg"
                    :class="{'-translate-x-5' : isFirstItemCol()}"
                  >
                    <template
                      x-if="isVisualSwatch(activeTooltipItem.attribute, activeTooltipItem.item)"
                    >
                      <div
                        class="border-container inline-block border shadow-sm"
                        :style="getTooltipImageStyle(activeTooltipItem.attribute, activeTooltipItem.item)"
                      ></div>
                    </template>
                    <span
                      class="subtitle mx-2 whitespace-nowrap text-lg font-semibold"
                      x-html="getTooltipLabel()"
                    ></span>
                  </div>
                  <svg
                    class="-translate-x-1/5 absolute z-10 h-8 w-8 -translate-y-8 transform fill-current stroke-current text-white"
                    width="12"
                    height="12"
                  >
                    <rect
                      x="12"
                      y="-12"
                      width="12"
                      height="12"
                      transform="rotate(45)"
                      class="shadow-xl"
                    ></rect>
                  </svg>
                </div>
              </div>
            </template>
          </div>
        </form>
        <style>
          .addtocart-wrap .addtocart-item {
            width: 100%;
          }
          .addtocart-wrap .addtocart-item button {
            width: 100%;
            display: flex;
            justify-content: center;
          }
        </style>
        <div
          class="addtocart-wrap my-4 flex flex-col items-end justify-end pl-1"
        >
          <div class="addtocart-item">
            <script>
              "use strict";

              (function () {
                let sharedOptions = {
                  bindSubmit: true,
                  // todo this has to go into hidden input before submit
                  minicartSelector: '[data-block="minicart"]',
                  messagesSelector: '[data-placeholder="messages"]',
                  formSelector: "#product_addtocart_form",
                  productStatusSelector: ".stock.available",
                  addToCartButtonSelector: "#product-addtocart-button",
                  addSaoToCartButtonSelector: ".saotocart",
                  addToCartButtonDisabledClass: "disabled",
                  addToCartButtonTextWhileAdding: "",
                  addToCartButtonTextAdded: "",
                  addToCartButtonTextDefault: "",
                };

                let elems = [];

                let Factory = function (selector, options) {
                  this.element = document.querySelector(selector);
                  this.options = {
                    bindSubmit:
                      "undefined" !== typeof options["bindSubmit"]
                        ? options["bindSubmit"]
                        : sharedOptions["bindSubmit"],

                    sao_pending_product_id: options["sao_pending_product_id"],
                    sao_pending_attribute_name:
                      options["sao_pending_attribute_name"],
                    return_url: options["return_url"],
                  };
                };

                Factory.prototype.init = function () {
                  if (this.options.bindSubmit) {
                    this.bindSubmit();
                  }
                };

                Factory.prototype.bindSubmit = function () {
                  if (
                    this.element.hasAttribute("data-sao-addtocart-initialized")
                  ) {
                    return;
                  }

                  this.element.setAttribute(
                    "data-sao-addtocart-initialized",
                    1,
                  );

                  this.element.addEventListener("click", (ev) => {
                    ev.preventDefault();
                    this.submitForm(sharedOptions.formSelector);
                  });

                  this.element.removeAttribute("disabled");
                };

                Factory.prototype.redirect = function (url) {
                  let urlParts, locationParts, forceReload;

                  urlParts = url.split("#");
                  locationParts = window.location.href.split("#");
                  forceReload = urlParts[0] === locationParts[0];
                  window.location.assign(url);

                  if (forceReload) {
                    window.location.reload();
                  }
                };

                Factory.prototype.appendFields = function (form, fields) {
                  fields.forEach(function (field) {
                    let elemType = field.elemType || "input";
                    let elem = document.createElement(elemType);

                    if (typeof field.attributes !== "undefined") {
                      Object.keys(field.attributes).forEach(function (key) {
                        elem.setAttribute(key, field.attributes[key]);
                      });
                    }
                    form.appendChild(elem);
                  });
                };

                Factory.prototype.beforeSubmit = function (form) {
                  if (!this.options.sao_pending_product_id) {
                    console.log("Empty sao_pending_product_id");
                  }

                  let fields = [
                    {
                      attributes: {
                        type: "hidden",
                        name: this.options.sao_pending_attribute_name,
                        value: this.options.sao_pending_product_id,
                      },
                    },
                    {
                      attributes: {
                        type: "hidden",
                        name: "return_url",
                        value: this.options.return_url,
                      },
                    },
                  ];

                  this.appendFields(form, fields);
                };

                Factory.prototype.isLoaderEnabled = function () {
                  return (
                    sharedOptions.processStart && sharedOptions.processStop
                  );
                };

                Factory.prototype.submitForm = function (selector) {
                  let form = document.querySelector(selector);
                  this.beforeSubmit(form);
                  this.ajaxSubmit(form);
                };

                Factory.prototype.ajaxSubmit = function (form) {
                  let formData = new FormData(form);
                  formData.append("isAjax", "1");
                  let productIds = this.resolveIds(formData);

                  if (!form.checkValidity()) {
                    form.reportValidity();
                    return;
                  }

                  this.saoAddToCartButtonsSetAdding();
                  window.dispatchEvent(
                    new CustomEvent("sao-add-to-cart", {
                      detail: {
                        loading: true,
                      },
                    }),
                  );

                  let url = form.getAttribute("action");

                  fetch(url, {
                    method: "POST",
                    body: formData,
                    cache: "no-store",
                  })
                    .then((response) => {
                      if (response.ok) {
                        return response.json().then((data) => {
                          if (data.backUrl) {
                            let eventData = {
                              form: form,
                              redirectParameters: [],
                            };

                            // trigger global event, so other modules will be able to add parameters to redirect url
                            document.body.dispatchEvent(
                              new CustomEvent(
                                "catalogCategoryAddToCartRedirect",
                                {
                                  detail: eventData,
                                },
                              ),
                            );

                            if (eventData.redirectParameters.length > 0) {
                              let parameters = data.backUrl.split("#");
                              parameters.push(
                                eventData.redirectParameters.join("&"),
                              );
                              data.backUrl = parameters.join("#");
                            }

                            this.redirect(data.backUrl);
                          }
                        });
                      } else {
                        window.dispatchMessages([
                          { type: "error", text: "Something went wrong" },
                        ]);
                        window.setTimeout(() => {
                          window.location.reload();
                        }, 1000);
                      }
                    })
                    .catch((reason) => {
                      console.log(reason);
                      window.location.reload();
                    })
                    .finally(() => {
                      window.dispatchEvent(
                        new CustomEvent("sao-add-to-cart", {
                          detail: {
                            loading: false,
                          },
                        }),
                      );
                    });
                };

                Factory.prototype.resolveIds = function (formData) {
                  let ids = [];
                  for (const entry of formData.entries()) {
                    if ("product" === entry[0]) {
                      ids.push(entry[1]);
                    }
                  }

                  return ids.filter((value, index, arr) => {
                    return arr.indexOf(value) === index;
                  });
                };

                Factory.prototype.disableAddToCartButton = function () {
                  let button = document.querySelector(
                    sharedOptions.addToCartButtonSelector,
                  );
                  button.setAttribute("disabled", "disabled");
                  button.classList.add(
                    sharedOptions.addToCartButtonDisabledClass,
                  );

                  return this;
                };

                Factory.prototype.enableAddToCartButton = function () {
                  let button = document.querySelector(
                    sharedOptions.addToCartButtonSelector,
                  );
                  button.removeAttribute("disabled");
                  button.classList.remove(
                    sharedOptions.addToCartButtonDisabledClass,
                  );

                  return this;
                };

                Factory.prototype.saoAddToCartButtonsSetAdding = function () {
                  let buttons = document.querySelectorAll(
                    sharedOptions.addSaoToCartButtonSelector,
                  );
                  buttons.forEach((button) => {
                    button.setAttribute("disabled", "disabled");
                    button.classList.add(
                      sharedOptions.addToCartButtonDisabledClass,
                    );

                    let text =
                      sharedOptions.addToCartButtonTextWhileAdding ||
                      "Adding...";

                    let textElem = button.querySelector("span");
                    textElem.innerHTML = text;
                    button.setAttribute("title", text);
                  });
                };

                Factory.prototype.saoAddToCartButtonsSetAdded = function () {
                  let buttons = document.querySelectorAll(
                    sharedOptions.addSaoToCartButtonSelector,
                  );
                  buttons.forEach((button) => {
                    button.classList.remove(
                      sharedOptions.addToCartButtonDisabledClass,
                    );

                    let textElem = button.querySelector("span");
                    textElem.innerHTML = sharedOptions.addToCartButtonTextAdded;
                    button.setAttribute(
                      "title",
                      sharedOptions.addToCartButtonTextAdded,
                    );
                  });
                };

                window.saoAddToCart_6671668f1fbe7 = function (elem, options) {
                  return new Factory(elem, options);
                };
              })();
            </script>
            <button
              type="button"
              title="Select Lenses"
              class="saotocart btn bg-s hover:bg-s mb-6 text-2xl"
              id="product-addtocart-sellsasone-49-button"
              data-sao-addtocart-initialized="1"
            >
              <span class="block min-w-fit px-1">Select Lenses</span>
              <script>
                let saoAddToCart = window.saoAddToCart_6671668f1fbe7(
                  "#" + "product-addtocart-sellsasone-49-button",
                  {
                    return_url: "https://www.spex4less.com/order-with-lenses",
                    sao_pending_product_id: "49",
                    sao_pending_attribute_name: "sao_pending_product_id",
                  },
                );

                saoAddToCart.init();
              </script>
            </button>
          </div>
          <div class="addtocart-item">
            <script>
              "use strict";
              function initLoader() {
                return {
                  isLoading: false,
                  changeState(loading) {
                    this.isLoading = loading;
                  },
                };
              }
            </script>
            <section
              x-data="initLoader()"
              @sao-add-to-cart.window="changeState($event.detail.loading)"
            >
              <div
                class="fixed z-50 flex h-full w-full select-none flex-row items-center justify-center"
                style="
                  left: 50%;
                  top: 50%;
                  transform: translateX(-50%) translateY(-50%);
                  background: rgba(255, 255, 255, 0.7);
                  display: none;
                "
                x-show="isLoading"
                x-transition:enter="ease-out duration-200"
                x-transition:enter-start="opacity-0"
                x-transition:enter-end="opacity-100"
                x-transition:leave="ease-in duration-200"
                x-transition:leave-start="opacity-100"
                x-transition:leave-end="opacity-0"
              >
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  viewBox="0 0 57 57"
                  stroke="currentColor"
                  class="text-primary"
                  width="57"
                  height="57"
                  role="img"
                >
                  <g fill="none" fill-rule="evenodd">
                    <g transform="translate(1 1)" stroke-width="2">
                      <circle cx="5" cy="50" r="5">
                        <animate
                          attributeName="cy"
                          begin="0s"
                          dur="2.2s"
                          values="50;5;50;50"
                          calcMode="linear"
                          repeatCount="indefinite"
                        ></animate>
                        <animate
                          attributeName="cx"
                          begin="0s"
                          dur="2.2s"
                          values="5;27;49;5"
                          calcMode="linear"
                          repeatCount="indefinite"
                        ></animate>
                      </circle>
                      <circle cx="27" cy="5" r="5">
                        <animate
                          attributeName="cy"
                          begin="0s"
                          dur="2.2s"
                          from="5"
                          to="5"
                          values="5;50;50;5"
                          calcMode="linear"
                          repeatCount="indefinite"
                        ></animate>
                        <animate
                          attributeName="cx"
                          begin="0s"
                          dur="2.2s"
                          from="27"
                          to="27"
                          values="27;49;5;27"
                          calcMode="linear"
                          repeatCount="indefinite"
                        ></animate>
                      </circle>
                      <circle cx="49" cy="50" r="5">
                        <animate
                          attributeName="cy"
                          begin="0s"
                          dur="2.2s"
                          values="50;50;5;50"
                          calcMode="linear"
                          repeatCount="indefinite"
                        ></animate>
                        <animate
                          attributeName="cx"
                          from="49"
                          to="49"
                          begin="0s"
                          dur="2.2s"
                          values="49;5;27;49"
                          calcMode="linear"
                          repeatCount="indefinite"
                        ></animate>
                      </circle>
                    </g>
                  </g>
                  <title>loader</title>
                </svg>
                <div class="text-primary ml-10 text-xl">Loading...</div>
              </div>
            </section>
          </div>
          <div class="addtocart-item rounded-lg border-2 border-gray-300">
            <button
              type="submit"
              form="product_addtocart_form"
              title="Order Frame Only"
              class="btn bg-white text-xl text-slate-700 hover:bg-white"
              id="product-addtocart-button"
            >
              <span class="block min-w-fit px-1">Order Frame Only </span>
            </button>
          </div>
        </div>
        <div class="mt-4 flex justify-end">
          <div wire:id="stripe.paymentrequest.product" class="hidden"></div>
        </div>
        <div class="mt-4 flex justify-end"></div>
      </div>
    </div>
  </div>
</section>